<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Mini Project #4</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="mp04_files/libs/clipboard/clipboard.min.js"></script>
<script src="mp04_files/libs/quarto-html/quarto.js"></script>
<script src="mp04_files/libs/quarto-html/popper.min.js"></script>
<script src="mp04_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="mp04_files/libs/quarto-html/anchor.min.js"></script>
<link href="mp04_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="mp04_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="mp04_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="mp04_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="mp04_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<link href="mp04_files/libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="mp04_files/libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<link href="mp04_files/libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="mp04_files/libs/datatables-binding-0.33/datatables.js"></script>
<script src="mp04_files/libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="mp04_files/libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="mp04_files/libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="mp04_files/libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script>
<link href="mp04_files/libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="mp04_files/libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Mini Project #4</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="how-should-a-cuny-employee-best-secure-their-retirement" class="level1">
<h1>How Should a CUNY Employee Best Secure Their Retirement?</h1>
<p>In this last project to wrap the semester, we are taking a dive into the wide world of financial data. Specifically, in this project we are going to analyze the two different retirement plans offered to CUNY employees and see how they differ. Is one better then the other? How do we even define better in this sense? Whats less risky, what will yield you more value over time on average? These questions we will aim to answer.</p>
<section id="tasks-1-3-acquiring-the-data" class="level2">
<h2 class="anchored" data-anchor-id="tasks-1-3-acquiring-the-data">Tasks 1-3: Acquiring the Data</h2>
<p>First to start off, we need to acquire our financial data that will serve as a basis on our calculations going forward. To do this we need to collect financial data covering these metrics:</p>
<ul>
<li><p>Wage growth</p></li>
<li><p>Inflation</p></li>
<li><p>US Equity Market total returns</p></li>
<li><p>International Equity Market total returns</p></li>
<li><p>Bond market total returns</p></li>
<li><p>Short-term debt returns</p></li>
</ul>
<p>To do this we are going to take advantage of the <strong>AlphaVantage</strong> and <strong>FRED</strong> APIs to acquire the time-series data. After its downloaded I will go over why I picked the specific funds that I did.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(httr2)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DT)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">warn=</span><span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co">#Task 1-2</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>api <span class="ot">&lt;-</span> <span class="fu">read_lines</span>(<span class="st">"api.txt"</span>)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co">#Task 3</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>alphavantage_req <span class="ot">&lt;-</span> <span class="fu">request</span>(<span class="st">"https://www.alphavantage.co/query"</span>) <span class="sc">|&gt;</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_url_query</span>(<span class="st">`</span><span class="at">function</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"TIME_SERIES_MONTHLY_ADJUSTED"</span>,</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>                <span class="at">symbol =</span> <span class="st">"VTI"</span>,</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>                <span class="at">apikey =</span> api[<span class="dv">1</span>],</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>                <span class="at">datatype =</span> <span class="st">"csv"</span>)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>resp <span class="ot">&lt;-</span> <span class="fu">req_perform</span>(alphavantage_req)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>csv <span class="ot">&lt;-</span> resp <span class="sc">|&gt;</span> <span class="fu">resp_body_string</span>()</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>VTI <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="at">text =</span> csv)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>fred_req <span class="ot">&lt;-</span> <span class="fu">request</span>(<span class="st">"https://api.stlouisfed.org/fred/series/observations"</span>) <span class="sc">|&gt;</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_url_query</span>(<span class="at">series_id =</span> <span class="st">"FRBATLWGT12MMUMHGO"</span>,</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>                <span class="at">api_key =</span> api[<span class="dv">2</span>],</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>                <span class="at">file_type =</span> <span class="st">"json"</span>)</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>resp2 <span class="ot">&lt;-</span> <span class="fu">req_perform</span>(fred_req)</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>json <span class="ot">&lt;-</span> resp2 <span class="sc">|&gt;</span> <span class="fu">resp_body_json</span>()</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>wages <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, <span class="fu">lapply</span>(json<span class="sc">$</span>observations, as.data.frame))</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>wages <span class="ot">&lt;-</span> <span class="fu">select</span>(wages, <span class="fu">c</span>(<span class="st">"date"</span>, <span class="st">"value"</span>))</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>alphavantage_req2 <span class="ot">&lt;-</span> <span class="fu">request</span>(<span class="st">"https://www.alphavantage.co/query"</span>) <span class="sc">|&gt;</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_url_query</span>(<span class="st">`</span><span class="at">function</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"TIME_SERIES_MONTHLY_ADJUSTED"</span>,</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>                <span class="at">symbol =</span> <span class="st">"VBTLX"</span>,</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>                <span class="at">apikey =</span> api[<span class="dv">1</span>],</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>                <span class="at">datatype =</span> <span class="st">"csv"</span>)</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>resp3 <span class="ot">&lt;-</span> <span class="fu">req_perform</span>(alphavantage_req2)</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>csv2 <span class="ot">&lt;-</span> resp3 <span class="sc">|&gt;</span> <span class="fu">resp_body_string</span>()</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>VBTLX <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="at">text =</span> csv2)</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>alphavantage_req3 <span class="ot">&lt;-</span> <span class="fu">request</span>(<span class="st">"https://www.alphavantage.co/query"</span>) <span class="sc">|&gt;</span></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_url_query</span>(<span class="st">`</span><span class="at">function</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"TIME_SERIES_MONTHLY_ADJUSTED"</span>,</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>                <span class="at">symbol =</span> <span class="st">"VEU"</span>,</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>                <span class="at">apikey =</span> api[<span class="dv">1</span>],</span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>                <span class="at">datatype =</span> <span class="st">"csv"</span>)</span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>resp4 <span class="ot">&lt;-</span> <span class="fu">req_perform</span>(alphavantage_req3)</span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>csv3 <span class="ot">&lt;-</span> resp4 <span class="sc">|&gt;</span> <span class="fu">resp_body_string</span>()</span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>VEU <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="at">text =</span> csv3)</span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>alphavantage_req4 <span class="ot">&lt;-</span> <span class="fu">request</span>(<span class="st">"https://www.alphavantage.co/query"</span>) <span class="sc">|&gt;</span></span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_url_query</span>(<span class="st">`</span><span class="at">function</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"TIME_SERIES_MONTHLY_ADJUSTED"</span>,</span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>                <span class="at">symbol =</span> <span class="st">"VBIRX"</span>,</span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>                <span class="at">apikey =</span> api[<span class="dv">1</span>],</span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>                <span class="at">datatype =</span> <span class="st">"csv"</span>)</span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>resp5 <span class="ot">&lt;-</span> <span class="fu">req_perform</span>(alphavantage_req4)</span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>csv4 <span class="ot">&lt;-</span> resp5 <span class="sc">|&gt;</span> <span class="fu">resp_body_string</span>()</span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a>VBIRX <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="at">text =</span> csv4)</span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a>fred_req2 <span class="ot">&lt;-</span> <span class="fu">request</span>(<span class="st">"https://api.stlouisfed.org/fred/series/observations"</span>) <span class="sc">|&gt;</span></span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_url_query</span>(<span class="at">series_id =</span> <span class="st">"CPIAUCSL"</span>,</span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>                <span class="at">api_key =</span> api[<span class="dv">2</span>],</span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a>                <span class="at">file_type =</span> <span class="st">"json"</span>)</span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a>resp6 <span class="ot">&lt;-</span> <span class="fu">req_perform</span>(fred_req2)</span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a>json2 <span class="ot">&lt;-</span> resp6 <span class="sc">|&gt;</span> <span class="fu">resp_body_json</span>()</span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a>inflation <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, <span class="fu">lapply</span>(json2<span class="sc">$</span>observations, as.data.frame))</span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a>inflation <span class="ot">&lt;-</span> <span class="fu">select</span>(inflation, <span class="fu">c</span>(<span class="st">"date"</span>, <span class="st">"value"</span>))</span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a>wages <span class="ot">&lt;-</span> wages <span class="sc">|&gt;</span> </span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">date =</span> <span class="fu">as.Date</span>(date)) <span class="sc">|&gt;</span> </span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">date =</span> <span class="fu">ceiling_date</span>(date, <span class="at">unit =</span> <span class="st">"month"</span>) <span class="sc">-</span> <span class="fu">days</span>(<span class="dv">1</span>))</span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a>inflation <span class="ot">&lt;-</span> inflation <span class="sc">|&gt;</span> </span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">date =</span> <span class="fu">as.Date</span>(date)) <span class="sc">|&gt;</span> </span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">date =</span> <span class="fu">ceiling_date</span>(date, <span class="at">unit =</span> <span class="st">"month"</span>) <span class="sc">-</span> <span class="fu">days</span>(<span class="dv">1</span>))</span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a>VTI <span class="ot">&lt;-</span> VTI <span class="sc">|&gt;</span> </span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">date =</span> timestamp) <span class="sc">|&gt;</span> </span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(date, close) <span class="sc">|&gt;</span> </span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">date =</span> <span class="fu">as.Date</span>(date)) <span class="sc">|&gt;</span> </span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">date =</span> <span class="fu">ceiling_date</span>(date, <span class="at">unit =</span> <span class="st">"month"</span>) <span class="sc">-</span> <span class="fu">days</span>(<span class="dv">1</span>))</span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a>VEU <span class="ot">&lt;-</span> VEU <span class="sc">|&gt;</span> </span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">date =</span> timestamp) <span class="sc">|&gt;</span> </span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(date, close) <span class="sc">|&gt;</span> </span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">date =</span> <span class="fu">as.Date</span>(date)) <span class="sc">|&gt;</span> </span>
<span id="cb1-75"><a href="#cb1-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">date =</span> <span class="fu">ceiling_date</span>(date, <span class="at">unit =</span> <span class="st">"month"</span>) <span class="sc">-</span> <span class="fu">days</span>(<span class="dv">1</span>))</span>
<span id="cb1-76"><a href="#cb1-76" aria-hidden="true" tabindex="-1"></a>VBIRX <span class="ot">&lt;-</span> VBIRX <span class="sc">|&gt;</span> </span>
<span id="cb1-77"><a href="#cb1-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">date =</span> timestamp) <span class="sc">|&gt;</span> </span>
<span id="cb1-78"><a href="#cb1-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(date, close) <span class="sc">|&gt;</span> </span>
<span id="cb1-79"><a href="#cb1-79" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">date =</span> <span class="fu">as.Date</span>(date)) <span class="sc">|&gt;</span> </span>
<span id="cb1-80"><a href="#cb1-80" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">date =</span> <span class="fu">ceiling_date</span>(date, <span class="at">unit =</span> <span class="st">"month"</span>) <span class="sc">-</span> <span class="fu">days</span>(<span class="dv">1</span>))</span>
<span id="cb1-81"><a href="#cb1-81" aria-hidden="true" tabindex="-1"></a>VBTLX <span class="ot">&lt;-</span> VBTLX <span class="sc">|&gt;</span> </span>
<span id="cb1-82"><a href="#cb1-82" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">date =</span> timestamp) <span class="sc">|&gt;</span> </span>
<span id="cb1-83"><a href="#cb1-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(date, close) <span class="sc">|&gt;</span> </span>
<span id="cb1-84"><a href="#cb1-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">date =</span> <span class="fu">as.Date</span>(date)) <span class="sc">|&gt;</span> </span>
<span id="cb1-85"><a href="#cb1-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">date =</span> <span class="fu">ceiling_date</span>(date, <span class="at">unit =</span> <span class="st">"month"</span>) <span class="sc">-</span> <span class="fu">days</span>(<span class="dv">1</span>))</span>
<span id="cb1-86"><a href="#cb1-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-87"><a href="#cb1-87" aria-hidden="true" tabindex="-1"></a>fred_data <span class="ot">&lt;-</span> <span class="fu">inner_join</span>(wages, inflation, <span class="at">by =</span> <span class="st">"date"</span>)</span>
<span id="cb1-88"><a href="#cb1-88" aria-hidden="true" tabindex="-1"></a>fred_data <span class="ot">&lt;-</span> fred_data <span class="sc">|&gt;</span> </span>
<span id="cb1-89"><a href="#cb1-89" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">wages_pct_change =</span> value.x,</span>
<span id="cb1-90"><a href="#cb1-90" aria-hidden="true" tabindex="-1"></a>         <span class="at">CPI =</span> value.y)</span>
<span id="cb1-91"><a href="#cb1-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-92"><a href="#cb1-92" aria-hidden="true" tabindex="-1"></a>indices <span class="ot">&lt;-</span> <span class="fu">inner_join</span>(VTI, VEU, <span class="at">by =</span> <span class="st">"date"</span>)</span>
<span id="cb1-93"><a href="#cb1-93" aria-hidden="true" tabindex="-1"></a>indices <span class="ot">&lt;-</span> indices <span class="sc">|&gt;</span> </span>
<span id="cb1-94"><a href="#cb1-94" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">VTI =</span> close.x,</span>
<span id="cb1-95"><a href="#cb1-95" aria-hidden="true" tabindex="-1"></a>         <span class="at">VEU =</span> close.y)</span>
<span id="cb1-96"><a href="#cb1-96" aria-hidden="true" tabindex="-1"></a>indices <span class="ot">&lt;-</span> <span class="fu">inner_join</span>(indices, VBIRX, <span class="at">by =</span> <span class="st">"date"</span>)</span>
<span id="cb1-97"><a href="#cb1-97" aria-hidden="true" tabindex="-1"></a>indices <span class="ot">&lt;-</span> indices <span class="sc">|&gt;</span> </span>
<span id="cb1-98"><a href="#cb1-98" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">VBIRX =</span> close)</span>
<span id="cb1-99"><a href="#cb1-99" aria-hidden="true" tabindex="-1"></a>indices <span class="ot">&lt;-</span> <span class="fu">inner_join</span>(indices, VBTLX, <span class="at">by =</span> <span class="st">"date"</span>)</span>
<span id="cb1-100"><a href="#cb1-100" aria-hidden="true" tabindex="-1"></a>indices <span class="ot">&lt;-</span> indices <span class="sc">|&gt;</span> </span>
<span id="cb1-101"><a href="#cb1-101" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">VBTLX =</span> close)</span>
<span id="cb1-102"><a href="#cb1-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-103"><a href="#cb1-103" aria-hidden="true" tabindex="-1"></a>indices_longer <span class="ot">&lt;-</span> indices <span class="sc">|&gt;</span> </span>
<span id="cb1-104"><a href="#cb1-104" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(VTI, VEU, VBIRX, VBTLX), <span class="at">names_to =</span> <span class="st">"ETF"</span>, <span class="at">values_to =</span> <span class="st">"Return"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="us-equity-market-total-returns" class="level3">
<h3 class="anchored" data-anchor-id="us-equity-market-total-returns">US Equity Market Total Returns</h3>
<p>For this metric, we are analyzing the <strong>Vanguard Total Stock Market Index Fund ETF (VTI)</strong>. Vanguard is one of the leading providers of ETFs and Mutual Funds in the market. For the sake of consistency in this analysis, all ETFs will be Vanguard provided funds. This ETF captures the total stock market as opposed to just top companies like an S&amp;P 500 index would capture.</p>
</section>
<section id="international-equity-market-total-returns" class="level3">
<h3 class="anchored" data-anchor-id="international-equity-market-total-returns">International Equity Market Total Returns</h3>
<p>For this metric, we are analyzing the <strong>Vanguard FTSE All World ex US ETF (VEU)</strong>, which as the name suggests aims to capture the whole world stock market excluding the US. We already have the US captured in <strong>VTI</strong> so there is no need to overlap the US in a global metric.</p>
</section>
<section id="bond-market-total-returns" class="level3">
<h3 class="anchored" data-anchor-id="bond-market-total-returns">Bond Market Total Returns</h3>
<p>For bonds we are using <strong>Vanguard Total Bond Market Index Fund Admiral Shares (VBTLX)</strong>, this aims to capture a broad array of US bonds, short intermediate and long term bonds. Bonds are usually tied to interest rates and are generally a less risky option then stocks. However as the interest rate fluctuates it could cause a downturn in price, and with less risk also comes less reward.</p>
</section>
<section id="short-term-debt-returns" class="level3">
<h3 class="anchored" data-anchor-id="short-term-debt-returns">Short-Term Debt Returns</h3>
<p>Simiarily, short-term debt returns is a type of bond investment that only focuses on short term investments. This is reserved for only the oldest of employees as it usually makes more sense to invest in longer term securities to increase the potential returns. Therefore this is the lowest risk and lowest return type investment. <strong>For this we are using Vanguard Short-Term Bond Index Fund Admiral Shares (VBIRX</strong>).</p>
</section>
<section id="inflation-and-wage-growth" class="level3">
<h3 class="anchored" data-anchor-id="inflation-and-wage-growth">Inflation and Wage Growth</h3>
<p>For these metrics we will take advantage of the FRED API to acquire data from the Federal Reserve Economic Data repository. For Inflation we will use a metric called the <strong>Consumer Price Index (CPI)</strong> which generally measures the cost of an identical basket of goods year over year. Wage growth we will look at the running average of salary increase percentage over the last 12 months.</p>
</section>
</section>
<section id="task-4---analysis" class="level2">
<h2 class="anchored" data-anchor-id="task-4---analysis">Task 4 - Analysis</h2>
<p>Now that we have the data, there are a few things that might be interesting to take a look at. First its probably worth comparing how US returns compare to the rest of the world. Maybe it can give us some insight on American economic domination or lack thereof.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>indices_longer <span class="sc">|&gt;</span> </span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ETF <span class="sc">==</span> <span class="st">"VEU"</span> <span class="sc">|</span> ETF <span class="sc">==</span> <span class="st">"VTI"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(date, Return, <span class="at">color =</span> ETF)) <span class="sc">+</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">1.2</span>, <span class="at">alpha =</span> .<span class="dv">8</span>) <span class="sc">+</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="st">"Date"</span>,</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="st">"Cumulative Returns"</span>,</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="st">"US Returns vs International Returns"</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> <span class="fu">dollar_format</span>()) <span class="sc">+</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mp04_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>While both economies were greatly affected by the 2008 financial crisis, it is actually quite wild to see how much the American market has pulled ahead over global competition.</p>
<p>Another thing worth looking at is the risk vs reward paradigm of bonds vs short term debt returns. Does this hold true?</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>indices_longer <span class="sc">|&gt;</span> </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ETF <span class="sc">==</span> <span class="st">"VBIRX"</span> <span class="sc">|</span> ETF <span class="sc">==</span> <span class="st">"VBTLX"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(date, Return, <span class="at">color =</span> ETF)) <span class="sc">+</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">1.2</span>, <span class="at">alpha =</span> .<span class="dv">8</span>) <span class="sc">+</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Date"</span>,</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Cumulative Returns"</span>,</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Short Debt vs Bond Market Returns"</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> <span class="fu">dollar_format</span>()) <span class="sc">+</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mp04_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>And our suspicions are confirmed. As we assumed <strong>VBTLX</strong> has higher highs and lower lows, where as <strong>VBIRX</strong> is less risky and doesnâ€™t fluctuate as much.</p>
<p>Lastly it might be interesting to see if wage growth is tied at all to inflation like it might be advertised. Generally companies try to account for inflation in annual salary adjustments, but how true is this in practice?</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a> fred_data <span class="ot">&lt;-</span> fred_data <span class="sc">|&gt;</span> </span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">wages_pct_change =</span> <span class="fu">as.numeric</span>(wages_pct_change),</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">CPI =</span> <span class="fu">as.numeric</span>(CPI),</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">CPI_pct_change =</span> (CPI <span class="sc">-</span> <span class="fu">lag</span>(CPI))<span class="sc">/</span><span class="fu">lag</span>(CPI)<span class="sc">*</span><span class="dv">100</span>)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>fred_data <span class="ot">&lt;-</span> fred_data <span class="sc">|&gt;</span> </span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">CPI_pct_change =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(CPI_pct_change), <span class="dv">0</span>, CPI_pct_change),</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">wages_monthly_change =</span> ((<span class="dv">1</span> <span class="sc">+</span> wages_pct_change <span class="sc">/</span> <span class="dv">100</span>)<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">12</span>) <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> <span class="dv">100</span>)</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>salary <span class="ot">&lt;-</span> fred_data <span class="sc">|&gt;</span> </span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">new_salary =</span> <span class="dv">161</span> <span class="sc">*</span> <span class="fu">cumprod</span>(<span class="dv">1</span> <span class="sc">+</span> wages_monthly_change <span class="sc">/</span> <span class="dv">100</span>))</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(salary<span class="sc">$</span>new_salary, salary<span class="sc">$</span>CPI)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9947642</code></pre>
</div>
</div>
<p>To test this, I simulated to see if wages grew at the same rate as the CPI and overall it is extremely correlated. While wage growth may take some time to see the effects in inflation due to weighted averaging it does generally match. As we see the correlation is near 1. I will also display the table if you want to take a look.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>salary <span class="sc">|&gt;</span> </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  DT<span class="sc">::</span><span class="fu">datatable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-9dac440a9306a75dcc86" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-9dac440a9306a75dcc86">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175","176","177","178","179","180","181","182","183","184","185","186","187","188","189","190","191","192","193","194","195","196","197","198","199","200","201","202","203","204","205","206","207","208","209","210","211","212","213","214","215","216","217","218","219","220","221","222","223","224","225","226","227","228","229","230","231","232","233","234","235","236","237","238","239","240","241","242","243","244","245","246","247","248","249","250","251","252","253","254","255","256","257","258","259","260","261","262","263","264","265","266","267","268","269","270","271","272","273","274","275","276","277","278","279","280","281","282","283","284","285","286","287","288","289","290","291","292","293","294","295","296","297","298","299","300","301","302","303","304","305","306","307","308","309","310","311","312","313","314","315","316","317","318","319","320","321","322","323"],["1997-12-31","1998-01-31","1998-02-28","1998-03-31","1998-04-30","1998-05-31","1998-06-30","1998-07-31","1998-08-31","1998-09-30","1998-10-31","1998-11-30","1998-12-31","1999-01-31","1999-02-28","1999-03-31","1999-04-30","1999-05-31","1999-06-30","1999-07-31","1999-08-31","1999-09-30","1999-10-31","1999-11-30","1999-12-31","2000-01-31","2000-02-29","2000-03-31","2000-04-30","2000-05-31","2000-06-30","2000-07-31","2000-08-31","2000-09-30","2000-10-31","2000-11-30","2000-12-31","2001-01-31","2001-02-28","2001-03-31","2001-04-30","2001-05-31","2001-06-30","2001-07-31","2001-08-31","2001-09-30","2001-10-31","2001-11-30","2001-12-31","2002-01-31","2002-02-28","2002-03-31","2002-04-30","2002-05-31","2002-06-30","2002-07-31","2002-08-31","2002-09-30","2002-10-31","2002-11-30","2002-12-31","2003-01-31","2003-02-28","2003-03-31","2003-04-30","2003-05-31","2003-06-30","2003-07-31","2003-08-31","2003-09-30","2003-10-31","2003-11-30","2003-12-31","2004-01-31","2004-02-29","2004-03-31","2004-04-30","2004-05-31","2004-06-30","2004-07-31","2004-08-31","2004-09-30","2004-10-31","2004-11-30","2004-12-31","2005-01-31","2005-02-28","2005-03-31","2005-04-30","2005-05-31","2005-06-30","2005-07-31","2005-08-31","2005-09-30","2005-10-31","2005-11-30","2005-12-31","2006-01-31","2006-02-28","2006-03-31","2006-04-30","2006-05-31","2006-06-30","2006-07-31","2006-08-31","2006-09-30","2006-10-31","2006-11-30","2006-12-31","2007-01-31","2007-02-28","2007-03-31","2007-04-30","2007-05-31","2007-06-30","2007-07-31","2007-08-31","2007-09-30","2007-10-31","2007-11-30","2007-12-31","2008-01-31","2008-02-29","2008-03-31","2008-04-30","2008-05-31","2008-06-30","2008-07-31","2008-08-31","2008-09-30","2008-10-31","2008-11-30","2008-12-31","2009-01-31","2009-02-28","2009-03-31","2009-04-30","2009-05-31","2009-06-30","2009-07-31","2009-08-31","2009-09-30","2009-10-31","2009-11-30","2009-12-31","2010-01-31","2010-02-28","2010-03-31","2010-04-30","2010-05-31","2010-06-30","2010-07-31","2010-08-31","2010-09-30","2010-10-31","2010-11-30","2010-12-31","2011-01-31","2011-02-28","2011-03-31","2011-04-30","2011-05-31","2011-06-30","2011-07-31","2011-08-31","2011-09-30","2011-10-31","2011-11-30","2011-12-31","2012-01-31","2012-02-29","2012-03-31","2012-04-30","2012-05-31","2012-06-30","2012-07-31","2012-08-31","2012-09-30","2012-10-31","2012-11-30","2012-12-31","2013-01-31","2013-02-28","2013-03-31","2013-04-30","2013-05-31","2013-06-30","2013-07-31","2013-08-31","2013-09-30","2013-10-31","2013-11-30","2013-12-31","2014-01-31","2014-02-28","2014-03-31","2014-04-30","2014-05-31","2014-06-30","2014-07-31","2014-08-31","2014-09-30","2014-10-31","2014-11-30","2014-12-31","2015-01-31","2015-02-28","2015-03-31","2015-04-30","2015-05-31","2015-06-30","2015-07-31","2015-08-31","2015-09-30","2015-10-31","2015-11-30","2015-12-31","2016-01-31","2016-02-29","2016-03-31","2016-04-30","2016-05-31","2016-06-30","2016-07-31","2016-08-31","2016-09-30","2016-10-31","2016-11-30","2016-12-31","2017-01-31","2017-02-28","2017-03-31","2017-04-30","2017-05-31","2017-06-30","2017-07-31","2017-08-31","2017-09-30","2017-10-31","2017-11-30","2017-12-31","2018-01-31","2018-02-28","2018-03-31","2018-04-30","2018-05-31","2018-06-30","2018-07-31","2018-08-31","2018-09-30","2018-10-31","2018-11-30","2018-12-31","2019-01-31","2019-02-28","2019-03-31","2019-04-30","2019-05-31","2019-06-30","2019-07-31","2019-08-31","2019-09-30","2019-10-31","2019-11-30","2019-12-31","2020-01-31","2020-02-29","2020-03-31","2020-04-30","2020-05-31","2020-06-30","2020-07-31","2020-08-31","2020-09-30","2020-10-31","2020-11-30","2020-12-31","2021-01-31","2021-02-28","2021-03-31","2021-04-30","2021-05-31","2021-06-30","2021-07-31","2021-08-31","2021-09-30","2021-10-31","2021-11-30","2021-12-31","2022-01-31","2022-02-28","2022-03-31","2022-04-30","2022-05-31","2022-06-30","2022-07-31","2022-08-31","2022-09-30","2022-10-31","2022-11-30","2022-12-31","2023-01-31","2023-02-28","2023-03-31","2023-04-30","2023-05-31","2023-06-30","2023-07-31","2023-08-31","2023-09-30","2023-10-31","2023-11-30","2023-12-31","2024-01-31","2024-02-29","2024-03-31","2024-04-30","2024-05-31","2024-06-30","2024-07-31","2024-08-31","2024-09-30","2024-10-31"],[4.7,4.7,4.7,4.7,4.8,4.9,4.9,5,5,5,5,5,5,5.1,5.1,5.2,5.1,5.1,5.1,5,5,5,5.1,5.1,5,5,5,4.9,4.9,4.9,5,5,5,5,5,5.1,5.1,5.1,5.2,5.2,5.2,5.2,5.3,5.2,5.2,5.2,5.2,5.1,5.1,5.1,5,4.9,4.8,4.8,4.7,4.6,4.5,4.4,4.3,4.1,4.1,4,4,3.9,3.8,3.7,3.7,3.7,3.6,3.6,3.6,3.6,3.5,3.5,3.4,3.5,3.4,3.4,3.4,3.4,3.4,3.4,3.5,3.5,3.5,3.5,3.5,3.5,3.6,3.6,3.7,3.7,3.7,3.7,3.8,3.8,3.9,3.9,3.9,3.9,4,4,3.9,3.9,3.9,3.9,3.8,3.8,3.9,3.9,3.9,4,4,4,4,4.1,4.1,4.2,4.2,4.2,4.2,4.1,4.1,4.1,4.1,4.1,4.1,4.1,4.1,4,4,4,4,3.9,3.8,3.8,3.7,3.7,3.6,3.4,3.3,3.1,3,2.8,2.6,2.5,2.4,2.3,2.1,2,1.9,1.8,1.8,1.8,1.7,1.7,1.8,1.8,1.8,1.8,1.8,1.9,1.9,1.9,2,1.9,2,2,2,2,2,2,2.1,2.1,2.1,2.1,2,2.1,2.1,2.1,2.2,2.2,2.2,2.2,2.2,2.2,2.2,2.2,2.3,2.2,2.3,2.2,2.2,2.2,2.3,2.3,2.3,2.3,2.3,2.3,2.3,2.4,2.5,2.5,2.6,2.6,2.7,2.8,2.9,2.9,3,3.1,3.1,3.1,3.1,3.1,3.1,3.1,3.2,3.1,3.1,3.2,3.2,3.2,3.3,3.4,3.5,3.5,3.5,3.5,3.5,3.5,3.5,3.5,3.4,3.5,3.5,3.4,3.3,3.3,3.3,3.3,3.2,3.3,3.2,3.2,3.3,3.2,3.2,3.2,3.3,3.4,3.5,3.5,3.5,3.5,3.6,3.6,3.7,3.7,3.7,3.7,3.7,3.6,3.7,3.7,3.7,3.7,3.6,3.7,3.6,3.6,3.6,3.6,3.6,3.6,3.5,3.5,3.5,3.5,3.5,3.4,3.4,3.5,3.5,3.6,3.6,3.7,3.8,4,4.3,4.5,4.7,5,5.3,5.5,5.7,5.9,6,6.2,6.3,6.3,6.3,6.4,6.3,6.3,6.1,6,6,5.8,5.8,5.6,5.6,5.5,5.4,5.2,5.3,5.2,5.1,5.1,5,5,4.9],[161.8,162,162,162,162.2,162.6,162.8,163.2,163.4,163.5,163.9,164.1,164.4,164.7,164.7,164.8,165.9,166,166,166.7,167.1,167.8,168.1,168.4,168.8,169.3,170,171,170.9,171.2,172.2,172.7,172.7,173.6,173.9,174.2,174.6,175.6,176,176.1,176.4,177.3,177.7,177.4,177.4,178.1,177.6,177.5,177.4,177.7,178,178.5,179.3,179.5,179.6,180,180.5,180.8,181.2,181.5,181.8,182.6,183.6,183.9,183.2,182.9,183.1,183.7,184.5,185.1,184.9,185,185.5,186.3,186.7,187.1,187.4,188.2,188.9,189.1,189.2,189.8,190.8,191.7,191.7,191.6,192.4,193.1,193.7,193.6,193.7,194.9,196.1,198.8,199.1,198.1,198.1,199.3,199.4,199.7,200.7,201.3,201.8,202.9,203.8,202.8,201.9,202,203.1,203.437,204.226,205.288,205.904,206.755,207.234,207.603,207.667,208.547,209.19,210.834,211.445,212.174,212.687,213.448,213.942,215.208,217.463,219.016,218.69,218.877,216.995,213.153,211.398,211.933,212.705,212.495,212.709,213.022,214.79,214.726,215.445,215.861,216.509,217.234,217.347,217.488,217.281,217.353,217.403,217.29,217.199,217.605,217.923,218.275,219.035,219.59,220.472,221.187,221.898,223.046,224.093,224.806,224.806,225.395,226.106,226.597,226.75,227.169,227.223,227.842,228.329,228.807,229.187,228.713,228.524,228.59,229.918,231.015,231.638,231.249,231.221,231.679,232.937,232.282,231.797,231.893,232.445,232.9,233.456,233.544,233.669,234.1,234.719,235.288,235.547,236.028,236.468,236.918,237.231,237.498,237.46,237.477,237.43,236.983,236.252,234.747,235.342,235.976,236.222,237.001,237.657,238.034,238.033,237.498,237.733,238.017,237.761,237.652,237.336,238.08,238.992,239.557,240.222,240.101,240.545,241.176,241.741,242.026,242.637,243.618,244.006,243.892,244.193,244.004,244.163,244.243,245.183,246.435,246.626,247.284,247.805,248.859,249.529,249.577,250.227,250.792,251.018,251.214,251.663,252.182,252.772,252.594,252.767,252.561,253.319,254.277,255.233,255.296,255.213,255.802,256.036,256.43,257.155,257.879,258.63,258.906,259.246,258.15,256.126,255.848,257.004,258.408,259.366,259.951,260.249,260.895,262.005,262.518,263.583,264.91,266.752,268.452,270.664,271.994,272.789,273.887,276.434,278.799,280.808,282.39,284.535,287.553,288.764,291.359,294.996,294.977,295.209,296.341,297.863,298.648,298.812,300.356,301.509,301.744,303.032,303.365,304.003,304.628,306.187,307.288,307.531,308.024,308.742,309.685,311.054,312.23,313.207,313.225,313.049,313.534,314.121,314.686,315.454],[0,0.1236093943139608,0,0,0.1234567901234498,0.2466091245376114,0.1230012300123106,0.2457002457002317,0.1225490196078536,0.06119951040391328,0.2446483180428169,0.1220256253813231,0.1828153564899521,0.1824817518248071,0,0.06071645415909092,0.6674757281553363,0.06027727546714546,0,0.4216867469879449,0.2399520095980838,0.4189108318372334,0.1787842669844952,0.178465199286146,0.2375296912114048,0.2962085308056872,0.4134672179562838,0.5882352941176471,-0.05847953216373936,0.1755412521942557,0.5841121495327104,0.2903600464576074,0,0.521134916039378,0.1728110599078407,0.1725129384703755,0.2296211251435165,0.5727376861397481,0.2277904328018256,0.05681818181817858,0.1703577512776896,0.5102040816326562,0.2256063169768625,-0.1688238604389324,0,0.3945885005636914,-0.2807411566535654,-0.05630630630630311,-0.05633802816901088,0.1691093573844323,0.1688238604389485,0.2808988764044944,0.4481792717086899,0.1115448968209641,0.05571030640668207,0.2227171492204931,0.2777777777777778,0.1662049861495908,0.2212389380530848,0.1655629139072911,0.1652892561983534,0.4400440044004307,0.547645125958379,0.1633986928104637,-0.3806416530723312,-0.1637554585152746,0.1093493712411091,0.3276897870016354,0.4354926510615195,0.3252032520325173,-0.108049702863311,0.05408328826392337,0.2702702702702703,0.4312668463611921,0.2147074610842604,0.2142474558114653,0.1603420630678842,0.4268943436499376,0.3719447396386913,0.1058761249338214,0.05288207297725771,0.3171247357293989,0.5268703898840885,0.4716981132075352,0,-0.0521648408972323,0.41753653444677,0.3638253638253579,0.3107198342827521,-0.05162622612286748,0.05165289256198054,0.6195147134744539,0.6157003591585369,1.376848546659876,0.1509054325955649,-0.5022601707684581,0,0.6057546693589183,0.05017561465127662,0.150451354062178,0.5007511266900351,0.2989536621823731,0.2483854942871336,0.5450941526263599,0.4435682602267154,-0.4906771344455348,-0.4437869822485235,0.04952947003466781,0.5445544554455417,0.1659281142294523,0.3878350545869175,0.5200121434097578,0.3000662483924951,0.4132994016629105,0.2316751710962315,0.1780595848171631,0.03082807088529209,0.4237553390765001,0.3083237831280243,0.7858884267890461,0.2898014551732596,0.3447705076970434,0.2417826877939828,0.357802780611883,0.2314381020201641,0.5917491656617172,1.047823500985091,0.7141444751520936,-0.1488475727800679,0.08550916822900537,-0.8598436564828671,-1.770547708472552,-0.8233522399403224,0.2530771341261491,0.3642660652187341,-0.09872828565384356,0.100708251958869,0.147149391892204,0.8299612246622419,-0.0297965454630071,0.3348453377793067,0.1930887233400621,0.3001931798703778,0.3348590589767736,0.05201763996427794,0.06487322116246884,-0.09517766497461637,0.03313681361923165,0.02300405331418611,-0.05197720362644469,-0.04187951585437884,0.1869253541682869,0.1461363479699511,0.1615249422961339,0.3481846294811549,0.2533841623484863,0.4016576346828202,0.324304220037013,0.3214474630064083,0.5173548206833753,0.4694098975099293,0.3181714734507648,0,0.2620036831757153,0.3154462166418884,0.2171547858084323,0.06752075270192967,0.1847850055126841,0.02377084901549157,0.2724196054096635,0.2137446124946212,0.2093470387029156,0.1660788350006879,-0.206818013238106,-0.08263631713107386,0.02888099280600834,0.5809527975851975,0.4771266277542341,0.2696794580438582,-0.1679344494426692,-0.0121081604677173,0.1980788942180851,0.542992675210101,-0.2811919102589975,-0.2087979266581197,0.04141554895016054,0.2380408205508543,0.1957452300544268,0.2387290682696364,0.0376944691933479,0.05352310485390333,0.1844489427352294,0.2644169158479281,0.2424175290453763,0.1100778620244067,0.2042055301065157,0.1864185605097691,0.1903005903547275,0.1321132206079691,0.1125485286492895,-0.01600013473796937,0.007159100480079132,-0.01979139032411435,-0.1882660152466001,-0.3084609444559291,-0.6370316441765553,0.253464368021742,0.2693951780812546,0.1042478896158971,0.3297745341246778,0.276792081046074,0.1586319780187334,-0.0004201080517929266,-0.2247587519377551,0.09894820166907244,0.119461749105085,-0.1075553426856066,-0.04584435630738804,-0.1329675323582272,0.3134796238244513,0.3830645161290229,0.2364095869317792,0.27759572878272,-0.05037007434789874,0.1849221785831748,0.2623209794425161,0.2342687497926934,0.1178947716771241,0.2524522158776288,0.404307669481569,0.1592657357009766,-0.04672016261895377,0.1234152821740837,-0.07739779600562725,0.06516286618252989,0.03276499715353435,0.3848626163288191,0.5106389920997825,0.07750522450139083,0.2668007428251632,0.2106889244755079,0.425334436351164,0.269228760060913,0.01923624107819204,0.260440665606208,0.22579497815983,0.09011451720947999,0.07808204989283556,0.1787320770339282,0.2062281702117423,0.2339580144498828,-0.07041919199911276,0.06848935445814304,-0.08149798035344363,0.3001255142321979,0.3781792917230837,0.3759679404743714,0.02468332856644249,-0.03251128102281211,0.2307876166182752,0.0914770017435395,0.1538846099767242,0.2827282299262824,0.2815422605043831,0.2912218521089256,0.1067161582183082,0.1313217924652094,-0.4227644785261889,-0.784040286655046,-0.1085403278073929,0.4518307745223749,0.5462949992996203,0.370731556298555,0.2255499949877919,0.1146369892787494,0.248223816421949,0.4254585177945203,0.1957977901185003,0.4056864672136976,0.503446732148886,0.6953304896002357,0.6372960652591129,0.8239834309299201,0.4913841515680109,0.2922858592468801,0.4025088988192388,0.9299455614906971,0.8555387542776763,0.7205908199096893,0.5633742628415123,0.7595878041007256,1.060677948231315,0.4211397551060197,0.8986577274175348,1.248288194289519,-0.006440765298514372,0.07865019984609911,0.3834571439217656,0.5135975109755286,0.2635439782718985,0.05491414641986125,0.5167128495508824,0.3838777983459695,0.07794128865142122,0.4268519009491337,0.109889384619455,0.2103077151286328,0.2055900764137196,0.5117717347059449,0.3595841756834872,0.07907890968732752,0.1603090420152749,0.2330987195802982,0.3054330152684065,0.4420620953549482,0.3780694027403746,0.3129103545463202,0.005746997991752772,-0.05618964003513275,0.1549278228009077,0.1872205247277773,0.1798669939290903,0.2440528018405741],[0.3834744881765939,0.3834744881765939,0.3834744881765939,0.3834744881765939,0.3914607630530309,0.3994400555316968,0.3994400555316968,0.4074123783648353,0.4074123783648353,0.4074123783648353,0.4074123783648353,0.4074123783648353,0.4074123783648353,0.4153777442692519,0.4153777442692519,0.4233361659264911,0.4153777442692519,0.4153777442692519,0.4153777442692519,0.4074123783648353,0.4074123783648353,0.4074123783648353,0.4153777442692519,0.4153777442692519,0.4074123783648353,0.4074123783648353,0.4074123783648353,0.3994400555316968,0.3994400555316968,0.3994400555316968,0.4074123783648353,0.4074123783648353,0.4074123783648353,0.4074123783648353,0.4074123783648353,0.4153777442692519,0.4153777442692519,0.4153777442692519,0.4233361659264911,0.4233361659264911,0.4233361659264911,0.4233361659264911,0.4312876559829704,0.4233361659264911,0.4233361659264911,0.4233361659264911,0.4233361659264911,0.4153777442692519,0.4153777442692519,0.4153777442692519,0.4074123783648353,0.3994400555316968,0.3914607630530309,0.3914607630530309,0.3834744881765939,0.375481218114615,0.3674809400436851,0.359473641104513,0.3514593084019246,0.335409489945282,0.335409489945282,0.3273739782198914,0.3273739782198914,0.3193313807882125,0.3112816845733057,0.3032248764614831,0.3032248764614831,0.3032248764614831,0.2951609433021529,0.2951609433021529,0.2951609433021529,0.2951609433021529,0.2870898719076642,0.2870898719076642,0.279011649053218,0.2870898719076642,0.279011649053218,0.279011649053218,0.279011649053218,0.279011649053218,0.279011649053218,0.279011649053218,0.2870898719076642,0.2870898719076642,0.2870898719076642,0.2870898719076642,0.2870898719076642,0.2870898719076642,0.2951609433021529,0.2951609433021529,0.3032248764614831,0.3032248764614831,0.3032248764614831,0.3032248764614831,0.3112816845733057,0.3112816845733057,0.3193313807882125,0.3193313807882125,0.3193313807882125,0.3193313807882125,0.3273739782198914,0.3273739782198914,0.3193313807882125,0.3193313807882125,0.3193313807882125,0.3193313807882125,0.3112816845733057,0.3112816845733057,0.3193313807882125,0.3193313807882125,0.3193313807882125,0.3273739782198914,0.3273739782198914,0.3273739782198914,0.3273739782198914,0.335409489945282,0.335409489945282,0.3434379290046863,0.3434379290046863,0.3434379290046863,0.3434379290046863,0.335409489945282,0.335409489945282,0.335409489945282,0.335409489945282,0.335409489945282,0.335409489945282,0.335409489945282,0.335409489945282,0.3273739782198914,0.3273739782198914,0.3273739782198914,0.3273739782198914,0.3193313807882125,0.3112816845733057,0.3112816845733057,0.3032248764614831,0.3032248764614831,0.2951609433021529,0.279011649053218,0.2709262614766672,0.2547339389213255,0.2466269772303686,0.2303913859575291,0.2141268142999309,0.2059836269842741,0.1978331538843303,0.1896753813568353,0.173337883251512,0.1651581301920224,0.1569710227413701,0.1487765470602476,0.1487765470602476,0.1487765470602476,0.140574689269668,0.140574689269668,0.1487765470602476,0.1487765470602476,0.1487765470602476,0.1487765470602476,0.1487765470602476,0.1569710227413701,0.1569710227413701,0.1569710227413701,0.1651581301920224,0.1569710227413701,0.1651581301920224,0.1651581301920224,0.1651581301920224,0.1651581301920224,0.1651581301920224,0.1651581301920224,0.173337883251512,0.173337883251512,0.173337883251512,0.173337883251512,0.1651581301920224,0.173337883251512,0.173337883251512,0.173337883251512,0.1815102957196446,0.1815102957196446,0.1815102957196446,0.1815102957196446,0.1815102957196446,0.1815102957196446,0.1815102957196446,0.1815102957196446,0.1896753813568353,0.1815102957196446,0.1896753813568353,0.1815102957196446,0.1815102957196446,0.1815102957196446,0.1896753813568353,0.1896753813568353,0.1896753813568353,0.1896753813568353,0.1896753813568353,0.1896753813568353,0.1896753813568353,0.1978331538843303,0.2059836269842741,0.2059836269842741,0.2141268142999309,0.2141268142999309,0.2222627294357071,0.2303913859575291,0.2385127973927093,0.2385127973927093,0.2466269772303686,0.2547339389213255,0.2547339389213255,0.2547339389213255,0.2547339389213255,0.2547339389213255,0.2547339389213255,0.2547339389213255,0.2628336958784505,0.2547339389213255,0.2547339389213255,0.2628336958784505,0.2628336958784505,0.2628336958784505,0.2709262614766672,0.279011649053218,0.2870898719076642,0.2870898719076642,0.2870898719076642,0.2870898719076642,0.2870898719076642,0.2870898719076642,0.2870898719076642,0.2870898719076642,0.279011649053218,0.2870898719076642,0.2870898719076642,0.279011649053218,0.2709262614766672,0.2709262614766672,0.2709262614766672,0.2709262614766672,0.2628336958784505,0.2709262614766672,0.2628336958784505,0.2628336958784505,0.2709262614766672,0.2628336958784505,0.2628336958784505,0.2628336958784505,0.2709262614766672,0.279011649053218,0.2870898719076642,0.2870898719076642,0.2870898719076642,0.2870898719076642,0.2951609433021529,0.2951609433021529,0.3032248764614831,0.3032248764614831,0.3032248764614831,0.3032248764614831,0.3032248764614831,0.2951609433021529,0.3032248764614831,0.3032248764614831,0.3032248764614831,0.3032248764614831,0.2951609433021529,0.3032248764614831,0.2951609433021529,0.2951609433021529,0.2951609433021529,0.2951609433021529,0.2951609433021529,0.2951609433021529,0.2870898719076642,0.2870898719076642,0.2870898719076642,0.2870898719076642,0.2870898719076642,0.279011649053218,0.279011649053218,0.2870898719076642,0.2870898719076642,0.2951609433021529,0.2951609433021529,0.3032248764614831,0.3112816845733057,0.3273739782198914,0.3514593084019246,0.3674809400436851,0.3834744881765939,0.4074123783648353,0.4312876559829704,0.4471698917043021,0.4630245519064768,0.4788517365088119,0.4867550565343048,0.5025412138836227,0.5104240758453837,0.5104240758453837,0.5104240758453837,0.5183001430342005,0.5104240758453837,0.5104240758453837,0.4946515448805977,0.4867550565343048,0.4867550565343048,0.4709415724342136,0.4709415724342136,0.4551006624873954,0.4551006624873954,0.4471698917043021,0.4392322270500904,0.4233361659264911,0.4312876559829704,0.4233361659264911,0.4153777442692519,0.4153777442692519,0.4074123783648353,0.4074123783648353,0.3994400555316968],[161.6173939259643,162.2371554001263,162.8592935014292,163.4838173436318,164.1237923424734,164.7793685097469,165.437563310827,166.1115764222205,166.7883355464616,167.4678518711465,168.1501366294513,168.835201100317,169.5230566086369,170.2272176571941,170.9343036340309,171.6579303612884,172.3709592002824,173.0869498023838,173.8059144700973,174.5140212799787,175.2250130046556,175.938901397628,176.6697124375455,177.4035591038756,178.1263231633245,178.852031853018,179.5806971697443,180.2980144062433,181.0181968951102,181.7412560813105,182.4816924551814,183.2251454584935,183.9716273813684,184.7211505639993,185.473727396855,186.2441439819282,187.0177607060339,187.7945908618375,188.5895932826093,189.3879612361483,190.1897089699718,190.994850791912,191.8185880069406,192.6306254629436,193.4461005671786,194.265027872454,195.0874219931853,195.8977717260136,196.7114874712828,197.5285832106595,198.3333391094685,199.1255619093452,199.9050603534291,200.6876102280703,201.4571960142263,202.2136299478,202.9567264960287,203.6863024306305,204.4021769004626,205.0877611994416,205.7756450132208,206.4493009285082,207.125162217965,207.7865778584355,208.4333794183105,209.0654012755561,209.6993395802976,210.3352001436805,210.9560275045211,211.5786873052562,212.2031849545327,212.8295258769617,213.4405378901836,214.0533040570115,214.6505377105139,215.2667776642761,215.867397050501,216.4696922347798,217.0736678927845,217.6793287132325,218.2866793979233,218.8957246617749,219.5241521173178,220.1543837244378,220.7864246626714,221.4202801264249,222.0559553250175,222.6934554827234,223.3507595865984,224.0100037954667,224.6892578527369,225.3705715772831,226.0539512145288,226.7394030288353,227.445201262175,228.153196516145,228.8817612688925,229.6126525575248,230.3458778114012,231.0814444836051,231.837945001339,232.5969221049131,233.3396770679417,234.0848038806495,234.8323101170969,235.5822033755307,236.315527626753,237.0511345820578,237.8081132432928,238.567509174939,239.3293300960994,240.112832045082,240.8988989755644,241.6875392846286,242.4787613968465,243.2920581736733,244.108082825071,244.9464425692584,245.7876815587889,246.6318096820831,247.478836861522,248.3089043659618,249.1417559955844,249.9774010886099,250.8158490145797,251.6571091744614,252.5011910007545,253.3481039575959,254.1978575408661,255.0300351796474,255.8649371514706,256.7025723750932,257.5429497984703,258.3653652561845,259.1696093175079,259.9763568432935,260.7646698301606,261.5553731781084,262.3273824848383,263.0593064406274,263.7720031850334,264.4439199985184,265.0961100448802,265.7068686469321,266.2758183001419,266.8243028884586,267.3521698221927,267.8592710698687,268.3235726604341,268.7667308559045,269.1886167421176,269.5891062711858,269.9901916347466,270.3918737192622,270.7719762555535,271.1526131198041,271.5560246148673,271.9600362916234,272.3646490430019,272.7698637632608,273.1756813479887,273.6044880088814,274.0339677719752,274.4641216938456,274.9174215052831,275.3489621935142,275.8037233909761,276.2592356635287,276.7155002516333,277.1725183978004,277.6302913465923,278.0888203446271,278.5708536193716,279.053722440391,279.5374282560037,280.0219725170384,280.4844515709744,280.9706373821771,281.4576659375737,281.945538697959,282.457298879018,282.969987957495,283.4836076194345,283.9981595539413,284.5136454531859,285.0300670124108,285.5474259299349,286.0657239071602,286.6083201599122,287.1285437693916,287.6731559297706,288.1953123258047,288.7184164894574,289.2424701410245,289.7910918993104,290.3407542580086,290.8914591908817,291.4432086754366,291.9960046929303,292.5498492283783,293.1047442705611,293.6846026303361,294.2895448267284,294.895733104998,295.5271839438022,296.1599868881714,296.8182401585254,297.5020838158014,298.2116643582121,298.9229373410242,299.6601619456366,300.4234980795388,301.188778689642,301.9560087291872,302.7251931640326,303.4963369726866,304.2694451463391,305.0445226888943,305.8462824819524,306.6253767643631,307.4064556643273,308.2144234131188,309.024514773406,309.8367353267554,310.6761644104575,311.5429870999944,312.4373954625971,313.3343715810223,314.233922827037,315.1360565935715,316.0407802947809,316.9481013661052,317.8580272643309,318.7705654676523,319.6599724790598,320.57768388459,321.4980299466188,322.3950469016465,323.2684997494031,324.1443190103058,325.0225110955895,325.9030824338583,326.759665550401,327.6449432962904,328.5061046101149,329.369529346048,330.2618778983486,331.1299173981064,332.0002383981631,332.8728468950703,333.7746868546341,334.7059571125494,335.6668640160912,336.6305295860314,337.596961742222,338.5661684272519,339.5654835236838,340.5677482079807,341.6004343417521,342.6362518367767,343.675210188121,344.7173189196427,345.7625875840781,346.7831436991772,347.8346764582483,348.8893977262289,349.9473171714715,351.008444491645,352.0444843274768,353.1119707801682,354.1542194040358,355.1995443387731,356.2479546644483,357.2994594879306,358.3540679429686,359.4117891902707,360.4436240354781,361.4784211740209,362.5161891103432,363.5569363733047,364.6006715162502,365.6179498623068,366.6380665334522,367.6906472890278,368.7462498973463,369.8346448069346,370.9262522332049,372.0509929033023,373.2091195014834,374.4309090430748,375.7468813264406,377.1276794981239,378.5738679368515,380.1162247360808,381.755619091756,383.4627152802237,385.2382417993784,387.0829618099307,388.9671076995233,390.9218277241645,392.9171868506035,394.9227307704233,396.9385114692616,398.9958443419646,401.0324151931086,403.0793811921984,405.0732195783607,407.0449339573247,409.0262457557287,410.9525203891594,412.8878666506381,414.7669220670952,416.6545290772011,418.5176826836567,420.3559472219065,422.1354659721197,423.9560841283837,425.7508435601449,427.5193178103323,429.2951379089681,431.0441394405277,432.8002666208245,434.529044246156]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>date<\/th>\n      <th>wages_pct_change<\/th>\n      <th>CPI<\/th>\n      <th>CPI_pct_change<\/th>\n      <th>wages_monthly_change<\/th>\n      <th>new_salary<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[2,3,4,5,6]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"date","targets":1},{"name":"wages_pct_change","targets":2},{"name":"CPI","targets":3},{"name":"CPI_pct_change","targets":4},{"name":"wages_monthly_change","targets":5},{"name":"new_salary","targets":6}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6.745736</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.215023</code></pre>
</div>
</div>
</section>
<section id="task-5---historical-battle" class="level2">
<h2 class="anchored" data-anchor-id="task-5---historical-battle">Task 5 - Historical Battle</h2>
<p>Now that we have looked into our data, its time to start the heavweight battle between our retirement options, those being <strong>Teachers Retirement System (TRS)</strong> and <strong>Optional Retirement Plan (OPR).</strong></p>
<p>TRS is calculated as follows:</p>
<p>It is based off of the average of the the last 3 years of salary issued to the employee, or <strong>Final Average Salary (FAS)</strong>.</p>
<p><span class="math display">\[
if(N&lt;20, .00167*FAS*N)
\]</span></p>
<p><span class="math display">\[
if(N = 20, .00175*FAS*N)
\]</span></p>
<p><span class="math display">\[
if(N&gt;20, (.035+.02*N)*FAS
\]</span></p>
<p>Its then adjusted for inflation.</p>
<p><span class="math display">\[
Inflation = max(.01, min(.03,mean(CPI*.5)))
\]</span></p>
<p>OPR is more convoluted and its asset allocation adjusts based on the employees age.</p>
<ul>
<li><p>Age 25 to Age 49:</p>
<ul>
<li><p>54% US Equities</p></li>
<li><p>36% International Equities</p></li>
<li><p>10% Bonds</p></li>
</ul></li>
<li><p>Age 50 to Age 59:</p>
<ul>
<li><p>47% US Equities</p></li>
<li><p>32% International Equities</p></li>
<li><p>21% Bonds</p></li>
</ul></li>
<li><p>Age 60 to Age 74:</p>
<ul>
<li><p>34% US Equities</p></li>
<li><p>23% International Equities</p></li>
<li><p>43% Bonds</p></li>
</ul></li>
<li><p>Age 75 or older:</p>
<ul>
<li><p>19% US Equities</p></li>
<li><p>13% International Equities</p></li>
<li><p>62% Bonds</p></li>
<li><p>6% Short-Term Debt</p></li>
</ul></li>
</ul>
<p>Furthermore both the employee and employer contribute to the fund,</p>
<ul>
<li><p>$45,000 or less: 3%</p></li>
<li><p>$45,001 to $55,000: 3.5%</p></li>
<li><p>$55,001 to $75,000: 4.5%</p></li>
<li><p>$75,001 to $100,000: 5.75%</p></li>
<li><p>$100,001 or more: 6%</p></li>
</ul>
<p>The employer contribution is fixed at:</p>
<ul>
<li><p>8% for the first seven years of employment at CUNY.</p></li>
<li><p>10% for all years thereafter.</p></li>
</ul>
<p>Using our historical data (2007-present), lets compare how these options would fare once an employee retires in this year of 2024 assuming they started in 2007.</p>
<p>For this we are assuming a starting salary of 50,000 and age between 25-49.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>orp <span class="ot">&lt;-</span> <span class="cf">function</span>(start, wages, returns, <span class="at">asset_allocation =</span> <span class="fu">c</span>(<span class="at">US_equities =</span> <span class="fl">0.54</span>, <span class="at">Intl_equities =</span> <span class="fl">0.36</span>, <span class="at">Bonds =</span> <span class="fl">0.1</span>, <span class="at">Short_term_debt =</span> <span class="dv">0</span>)) {</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  returns<span class="sc">$</span>VTI_return <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">diff</span>(returns<span class="sc">$</span>VTI) <span class="sc">/</span> <span class="fu">head</span>(returns<span class="sc">$</span>VTI, <span class="sc">-</span><span class="dv">1</span>))</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  returns<span class="sc">$</span>VEU_return <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">diff</span>(returns<span class="sc">$</span>VEU) <span class="sc">/</span> <span class="fu">head</span>(returns<span class="sc">$</span>VEU, <span class="sc">-</span><span class="dv">1</span>))</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  returns<span class="sc">$</span>VBTLX_return <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">diff</span>(returns<span class="sc">$</span>VBTLX) <span class="sc">/</span> <span class="fu">head</span>(returns<span class="sc">$</span>VBTLX, <span class="sc">-</span><span class="dv">1</span>))</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  returns<span class="sc">$</span>VBIRX_return <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">diff</span>(returns<span class="sc">$</span>VBIRX) <span class="sc">/</span> <span class="fu">head</span>(returns<span class="sc">$</span>VBIRX, <span class="sc">-</span><span class="dv">1</span>))</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  months <span class="ot">&lt;-</span> <span class="fu">length</span>(wages<span class="sc">$</span>date)</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  salary <span class="ot">&lt;-</span> <span class="fu">numeric</span>(months)</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  salary[<span class="dv">1</span>] <span class="ot">&lt;-</span> start</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>months) {</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>    salary[i] <span class="ot">&lt;-</span> salary[i <span class="sc">-</span> <span class="dv">1</span>] <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">+</span> (<span class="fu">as.numeric</span>(wages<span class="sc">$</span>value[i <span class="sc">-</span> <span class="dv">1</span>]))<span class="sc">/</span><span class="dv">1200</span>)</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>  monthly <span class="ot">&lt;-</span> salary <span class="sc">/</span> <span class="dv">12</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>  employee_rate <span class="ot">&lt;-</span> <span class="fu">sapply</span>(salary, <span class="cf">function</span>(s) {</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (s <span class="sc">&lt;=</span> <span class="dv">45000</span>) <span class="fu">return</span>(<span class="fl">0.03</span>)</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (s <span class="sc">&lt;=</span> <span class="dv">55000</span>) <span class="fu">return</span>(<span class="fl">0.035</span>)</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (s <span class="sc">&lt;=</span> <span class="dv">75000</span>) <span class="fu">return</span>(<span class="fl">0.045</span>)</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (s <span class="sc">&lt;=</span> <span class="dv">100000</span>) <span class="fu">return</span>(<span class="fl">0.0575</span>)</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fl">0.06</span>)</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>  employer_rate <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(.<span class="dv">08</span>, <span class="dv">7</span> <span class="sc">*</span> <span class="dv">12</span>), <span class="fu">rep</span>(.<span class="dv">1</span>, (months <span class="sc">-</span> <span class="dv">7</span> <span class="sc">*</span> <span class="dv">12</span>)))</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>  employee_contribution <span class="ot">&lt;-</span> monthly <span class="sc">*</span> employee_rate</span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>  employer_contribution <span class="ot">&lt;-</span> monthly <span class="sc">*</span> employer_rate</span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>  total_contribution <span class="ot">&lt;-</span> employee_contribution <span class="sc">+</span> employer_contribution</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>  orp_balance <span class="ot">&lt;-</span> <span class="fu">numeric</span>(months)</span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>months) {</span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>    growth_rate <span class="ot">&lt;-</span> <span class="fu">sum</span>(</span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>      returns<span class="sc">$</span>VTI_return[i] <span class="sc">*</span> asset_allocation[<span class="st">"US_equities"</span>],</span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>      returns<span class="sc">$</span>VEU_return[i] <span class="sc">*</span> asset_allocation[<span class="st">"Intl_equities"</span>],</span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>      returns<span class="sc">$</span>VBTLX_return[i] <span class="sc">*</span> asset_allocation[<span class="st">"Bonds"</span>],</span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a>      returns<span class="sc">$</span>VBIRX_return[i] <span class="sc">*</span> asset_allocation[<span class="st">"Short_term_debt"</span>]</span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (i <span class="sc">==</span> <span class="dv">1</span>) {</span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a>      orp_balance[i] <span class="ot">&lt;-</span> total_contribution[i]</span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a>      orp_balance[i] <span class="ot">&lt;-</span> (orp_balance[i <span class="sc">-</span> <span class="dv">1</span>]<span class="sc">*</span>(<span class="dv">1</span><span class="sc">+</span> growth_rate) <span class="sc">+</span> total_contribution[i]) </span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(orp_balance[months])</span>
<span id="cb9-39"><a href="#cb9-39" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb9-40"><a href="#cb9-40" aria-hidden="true" tabindex="-1"></a>orp_returns <span class="ot">&lt;-</span> <span class="fu">orp</span>(<span class="dv">50000</span>, <span class="fu">filter</span>(wages, date <span class="sc">&gt;=</span> <span class="st">"2007-04-30"</span>), indices)</span>
<span id="cb9-41"><a href="#cb9-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-42"><a href="#cb9-42" aria-hidden="true" tabindex="-1"></a>trs <span class="ot">&lt;-</span> <span class="cf">function</span>(start, wages, inflation, retirement_years) {</span>
<span id="cb9-43"><a href="#cb9-43" aria-hidden="true" tabindex="-1"></a>  months <span class="ot">&lt;-</span> <span class="fu">length</span>(wages<span class="sc">$</span>date)</span>
<span id="cb9-44"><a href="#cb9-44" aria-hidden="true" tabindex="-1"></a>  service_years <span class="ot">&lt;-</span> months <span class="sc">%/%</span> <span class="dv">12</span></span>
<span id="cb9-45"><a href="#cb9-45" aria-hidden="true" tabindex="-1"></a>  salary <span class="ot">&lt;-</span> <span class="fu">numeric</span>(months)</span>
<span id="cb9-46"><a href="#cb9-46" aria-hidden="true" tabindex="-1"></a>  salary[<span class="dv">1</span>] <span class="ot">&lt;-</span> start</span>
<span id="cb9-47"><a href="#cb9-47" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>months) {</span>
<span id="cb9-48"><a href="#cb9-48" aria-hidden="true" tabindex="-1"></a>    salary[i] <span class="ot">&lt;-</span> salary[i <span class="sc">-</span> <span class="dv">1</span>] <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">+</span> (<span class="fu">as.numeric</span>(wages<span class="sc">$</span>value[i <span class="sc">-</span> <span class="dv">1</span>]))<span class="sc">/</span><span class="dv">1200</span>)</span>
<span id="cb9-49"><a href="#cb9-49" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb9-50"><a href="#cb9-50" aria-hidden="true" tabindex="-1"></a>  cpi <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(inflation<span class="sc">$</span>value)</span>
<span id="cb9-51"><a href="#cb9-51" aria-hidden="true" tabindex="-1"></a>  final_3_years <span class="ot">&lt;-</span> salary[(months <span class="sc">-</span> <span class="dv">35</span>)<span class="sc">:</span>months]  </span>
<span id="cb9-52"><a href="#cb9-52" aria-hidden="true" tabindex="-1"></a>  FAS <span class="ot">&lt;-</span> <span class="fu">mean</span>(final_3_years)</span>
<span id="cb9-53"><a href="#cb9-53" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-54"><a href="#cb9-54" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (service_years <span class="sc">&lt;</span> <span class="dv">20</span>) {</span>
<span id="cb9-55"><a href="#cb9-55" aria-hidden="true" tabindex="-1"></a>    benefit_rate <span class="ot">&lt;-</span> <span class="fl">0.0167</span> <span class="sc">*</span> service_years</span>
<span id="cb9-56"><a href="#cb9-56" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (service_years <span class="sc">==</span> <span class="dv">20</span>) {</span>
<span id="cb9-57"><a href="#cb9-57" aria-hidden="true" tabindex="-1"></a>    benefit_rate <span class="ot">&lt;-</span> <span class="fl">0.0175</span> <span class="sc">*</span> service_years</span>
<span id="cb9-58"><a href="#cb9-58" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb9-59"><a href="#cb9-59" aria-hidden="true" tabindex="-1"></a>    benefit_rate <span class="ot">&lt;-</span> <span class="fl">0.35</span> <span class="sc">+</span> <span class="fl">0.02</span> <span class="sc">*</span> service_years</span>
<span id="cb9-60"><a href="#cb9-60" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb9-61"><a href="#cb9-61" aria-hidden="true" tabindex="-1"></a>  annual_benefit <span class="ot">&lt;-</span> FAS <span class="sc">*</span> benefit_rate </span>
<span id="cb9-62"><a href="#cb9-62" aria-hidden="true" tabindex="-1"></a>  monthly_benefit <span class="ot">&lt;-</span> annual_benefit <span class="sc">/</span> <span class="dv">12</span></span>
<span id="cb9-63"><a href="#cb9-63" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-64"><a href="#cb9-64" aria-hidden="true" tabindex="-1"></a>  inflation_rate <span class="ot">&lt;-</span> <span class="fu">numeric</span>(months)</span>
<span id="cb9-65"><a href="#cb9-65" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">13</span><span class="sc">:</span>months) {</span>
<span id="cb9-66"><a href="#cb9-66" aria-hidden="true" tabindex="-1"></a>    inflation_rate[i] <span class="ot">&lt;-</span> (cpi[i] <span class="sc">-</span> cpi[i <span class="sc">-</span> <span class="dv">12</span>]) <span class="sc">/</span> cpi[i <span class="sc">-</span> <span class="dv">12</span>]</span>
<span id="cb9-67"><a href="#cb9-67" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb9-68"><a href="#cb9-68" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-69"><a href="#cb9-69" aria-hidden="true" tabindex="-1"></a>  trs_balance <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb9-70"><a href="#cb9-70" aria-hidden="true" tabindex="-1"></a>  inflation_adjusted_benefit <span class="ot">&lt;-</span> monthly_benefit</span>
<span id="cb9-71"><a href="#cb9-71" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (year <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>retirement_years) {</span>
<span id="cb9-72"><a href="#cb9-72" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (retirement_years <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb9-73"><a href="#cb9-73" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(monthly_benefit<span class="sc">*</span><span class="dv">12</span>)</span>
<span id="cb9-74"><a href="#cb9-74" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb9-75"><a href="#cb9-75" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (year <span class="sc">==</span> <span class="dv">1</span>) {</span>
<span id="cb9-76"><a href="#cb9-76" aria-hidden="true" tabindex="-1"></a>      inflation_rate <span class="ot">&lt;-</span> <span class="fu">max</span>(<span class="fl">0.01</span>, <span class="fu">min</span>(<span class="fl">0.03</span>, <span class="fu">mean</span>(cpi[<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>]) <span class="sc">/</span> <span class="dv">200</span>))</span>
<span id="cb9-77"><a href="#cb9-77" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb9-78"><a href="#cb9-78" aria-hidden="true" tabindex="-1"></a>      inflation_rate <span class="ot">&lt;-</span> <span class="fu">max</span>(<span class="fl">0.01</span>, <span class="fu">min</span>(<span class="fl">0.03</span>, <span class="fu">mean</span>(cpi[((year <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> <span class="dv">12</span> <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>(year <span class="sc">*</span> <span class="dv">12</span>)]) <span class="sc">/</span> <span class="dv">200</span>))</span>
<span id="cb9-79"><a href="#cb9-79" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb9-80"><a href="#cb9-80" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-81"><a href="#cb9-81" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Adjust benefit for inflation</span></span>
<span id="cb9-82"><a href="#cb9-82" aria-hidden="true" tabindex="-1"></a>    inflation_adjusted_benefit <span class="ot">&lt;-</span> inflation_adjusted_benefit <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">+</span> inflation_rate)</span>
<span id="cb9-83"><a href="#cb9-83" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-84"><a href="#cb9-84" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add 12 months of benefit payments</span></span>
<span id="cb9-85"><a href="#cb9-85" aria-hidden="true" tabindex="-1"></a>    trs_balance <span class="ot">&lt;-</span> trs_balance <span class="sc">+</span> inflation_adjusted_benefit <span class="sc">*</span> <span class="dv">12</span></span>
<span id="cb9-86"><a href="#cb9-86" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb9-87"><a href="#cb9-87" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-88"><a href="#cb9-88" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(trs_balance)</span>
<span id="cb9-89"><a href="#cb9-89" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb9-90"><a href="#cb9-90" aria-hidden="true" tabindex="-1"></a><span class="fu">trs</span>(<span class="dv">50000</span>, <span class="fu">filter</span>(wages, date <span class="sc">&gt;=</span> <span class="st">"2007-04-30"</span>), inflation, <span class="dv">0</span>)<span class="sc">/</span><span class="dv">12</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1989.073</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>orp_returns</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 281857.8</code></pre>
</div>
</div>
<p>What we find is that by the time of retirement, approximately $282,000 have accumulated in the ORP fund whereas the TRS will start to pay around $2000 monthly. Given an annual withdrawal of 4% of ORP along with dividing that monthly thats about half of what TRS offers. This isnt that surprising because the longer you work the more you have to contribute to ORP, 17 years here perhaps not being long enough for ORP to overcome the potential TRS benefit.</p>
</section>
<section id="task-6---simulation-till-death" class="level2">
<h2 class="anchored" data-anchor-id="task-6---simulation-till-death">Task 6 - Simulation Till Death</h2>
<p>While its useful to see how each retirement stacks up once an employee decides to end his career, what is more important is seeing how each fares during actual retirement. For this were going to assume a retirement duration of 15 years. How does each plan fare after being used for 15 straight years? In this analysis we will assume rates are fixed, this isnt relevant for TRS but for ORP we will assume these market returns based on long run averages of our data.</p>
<p>US Returns - 7%</p>
<p>International Returns - 4%</p>
<p>Bonds - 2%</p>
<p>Short-Term Debt - 1%</p>
<section id="trs-after-15-years" class="level3">
<h3 class="anchored" data-anchor-id="trs-after-15-years">TRS After 15 Years</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>trs15 <span class="ot">&lt;-</span> <span class="fu">trs</span>(<span class="dv">50000</span>, <span class="fu">filter</span>(wages, date <span class="sc">&gt;=</span> <span class="st">"2007-04-30"</span>), inflation, <span class="dv">15</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>trs15<span class="sc">/</span>(<span class="dv">12</span><span class="sc">*</span><span class="dv">15</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2540.296</code></pre>
</div>
</div>
<p>After 15 years we find that the average monthly payment works to around $2550.</p>
</section>
<section id="orp-fixed-simulation" class="level3">
<h3 class="anchored" data-anchor-id="orp-fixed-simulation">ORP Fixed Simulation</h3>
<p>For ORP we will conduct a fixed simulation, prefaced on the assumption of 4% withdrawals annually, a 2.5% annual inflation rate and a starting balance of $290,000 as calculated previously.av</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>simulate_orp_withdrawals <span class="ot">&lt;-</span> <span class="cf">function</span>(</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>    initial_balance, </span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>    annual_withdrawal, </span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">average_returns =</span> <span class="fu">c</span>(<span class="at">US_equities =</span> <span class="fl">0.07</span>, <span class="at">Intl_equities =</span> <span class="fl">0.04</span>, <span class="at">Bonds =</span> <span class="fl">0.02</span>, <span class="at">Short_term_debt =</span> .<span class="dv">01</span>),</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">asset_allocation =</span> <span class="fu">c</span>(<span class="at">US_equities =</span> <span class="fl">0.54</span>, <span class="at">Intl_equities =</span> <span class="fl">0.36</span>, <span class="at">Bonds =</span> <span class="fl">0.1</span>, <span class="at">Short_term_debt =</span> <span class="dv">0</span>),</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">inflation_rate =</span> <span class="fl">0.025</span>,</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">retirement_years =</span> <span class="dv">15</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>) {</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Number of months in retirement</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>  months <span class="ot">&lt;-</span> retirement_years <span class="sc">*</span> <span class="dv">12</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Convert annual growth and inflation rates to monthly rates</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>  monthly_growth_rate <span class="ot">&lt;-</span> <span class="fu">sum</span>(</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>    average_returns[<span class="st">"US_equities"</span>] <span class="sc">*</span> asset_allocation[<span class="st">"US_equities"</span>],</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>    average_returns[<span class="st">"Intl_equities"</span>] <span class="sc">*</span> asset_allocation[<span class="st">"Intl_equities"</span>],</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>    average_returns[<span class="st">"Bonds"</span>] <span class="sc">*</span> asset_allocation[<span class="st">"Bonds"</span>]</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>  monthly_growth_rate <span class="ot">&lt;-</span> (<span class="dv">1</span> <span class="sc">+</span> monthly_growth_rate)<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">/</span> <span class="dv">12</span>) <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>  monthly_inflation_rate <span class="ot">&lt;-</span> (<span class="dv">1</span> <span class="sc">+</span> inflation_rate)<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">/</span> <span class="dv">12</span>) <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Initialize vectors to track balances and withdrawals</span></span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>  orp_balance <span class="ot">&lt;-</span> <span class="fu">numeric</span>(months)</span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>  withdrawals <span class="ot">&lt;-</span> <span class="fu">numeric</span>(months)</span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Set initial values</span></span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>  orp_balance[<span class="dv">1</span>] <span class="ot">&lt;-</span> initial_balance</span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a>  withdrawals[<span class="dv">1</span>] <span class="ot">&lt;-</span> annual_withdrawal <span class="sc">/</span> <span class="dv">12</span></span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Simulate withdrawals and returns over retirement</span></span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>months) {</span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Adjust withdrawal for inflation annually</span></span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (i <span class="sc">%%</span> <span class="dv">12</span> <span class="sc">==</span> <span class="dv">1</span>) {</span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a>      withdrawals[i] <span class="ot">&lt;-</span> withdrawals[i <span class="sc">-</span> <span class="dv">1</span>] <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">+</span> inflation_rate)</span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb15-35"><a href="#cb15-35" aria-hidden="true" tabindex="-1"></a>      withdrawals[i] <span class="ot">&lt;-</span> withdrawals[i <span class="sc">-</span> <span class="dv">1</span>]</span>
<span id="cb15-36"><a href="#cb15-36" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb15-37"><a href="#cb15-37" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb15-38"><a href="#cb15-38" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Update ORP balance: apply growth, then subtract withdrawal</span></span>
<span id="cb15-39"><a href="#cb15-39" aria-hidden="true" tabindex="-1"></a>    orp_balance[i] <span class="ot">&lt;-</span> orp_balance[i <span class="sc">-</span> <span class="dv">1</span>] <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">+</span> monthly_growth_rate) <span class="sc">-</span> withdrawals[i]</span>
<span id="cb15-40"><a href="#cb15-40" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb15-41"><a href="#cb15-41" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Prevent negative balance</span></span>
<span id="cb15-42"><a href="#cb15-42" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (orp_balance[i] <span class="sc">&lt;</span> <span class="dv">0</span>) {</span>
<span id="cb15-43"><a href="#cb15-43" aria-hidden="true" tabindex="-1"></a>      orp_balance[i] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb15-44"><a href="#cb15-44" aria-hidden="true" tabindex="-1"></a>      withdrawals[i] <span class="ot">&lt;-</span> <span class="dv">0</span> <span class="co"># No more withdrawals if the balance is exhausted</span></span>
<span id="cb15-45"><a href="#cb15-45" aria-hidden="true" tabindex="-1"></a>      <span class="cf">break</span></span>
<span id="cb15-46"><a href="#cb15-46" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb15-47"><a href="#cb15-47" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb15-48"><a href="#cb15-48" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb15-49"><a href="#cb15-49" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Return a list of results</span></span>
<span id="cb15-50"><a href="#cb15-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(</span>
<span id="cb15-51"><a href="#cb15-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">final_balance =</span> orp_balance[months],</span>
<span id="cb15-52"><a href="#cb15-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_withdrawn =</span> <span class="fu">sum</span>(withdrawals),</span>
<span id="cb15-53"><a href="#cb15-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">funds_exhausted =</span> <span class="fu">any</span>(orp_balance <span class="sc">==</span> <span class="dv">0</span>),</span>
<span id="cb15-54"><a href="#cb15-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">withdrawals =</span> withdrawals,</span>
<span id="cb15-55"><a href="#cb15-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">balances =</span> orp_balance</span>
<span id="cb15-56"><a href="#cb15-56" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb15-57"><a href="#cb15-57" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb15-58"><a href="#cb15-58" aria-hidden="true" tabindex="-1"></a>orp_simulation <span class="ot">&lt;-</span> <span class="fu">simulate_orp_withdrawals</span>(<span class="dv">290000</span>, .<span class="dv">04</span><span class="sc">*</span><span class="dv">290000</span>)</span>
<span id="cb15-59"><a href="#cb15-59" aria-hidden="true" tabindex="-1"></a>orp_simulation</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$final_balance
[1] 330501.4

$total_withdrawn
[1] 208010.3

$funds_exhausted
[1] FALSE

$withdrawals
  [1]  966.6667  966.6667  966.6667  966.6667  966.6667  966.6667  966.6667
  [8]  966.6667  966.6667  966.6667  966.6667  966.6667  990.8333  990.8333
 [15]  990.8333  990.8333  990.8333  990.8333  990.8333  990.8333  990.8333
 [22]  990.8333  990.8333  990.8333 1015.6042 1015.6042 1015.6042 1015.6042
 [29] 1015.6042 1015.6042 1015.6042 1015.6042 1015.6042 1015.6042 1015.6042
 [36] 1015.6042 1040.9943 1040.9943 1040.9943 1040.9943 1040.9943 1040.9943
 [43] 1040.9943 1040.9943 1040.9943 1040.9943 1040.9943 1040.9943 1067.0191
 [50] 1067.0191 1067.0191 1067.0191 1067.0191 1067.0191 1067.0191 1067.0191
 [57] 1067.0191 1067.0191 1067.0191 1067.0191 1093.6946 1093.6946 1093.6946
 [64] 1093.6946 1093.6946 1093.6946 1093.6946 1093.6946 1093.6946 1093.6946
 [71] 1093.6946 1093.6946 1121.0370 1121.0370 1121.0370 1121.0370 1121.0370
 [78] 1121.0370 1121.0370 1121.0370 1121.0370 1121.0370 1121.0370 1121.0370
 [85] 1149.0629 1149.0629 1149.0629 1149.0629 1149.0629 1149.0629 1149.0629
 [92] 1149.0629 1149.0629 1149.0629 1149.0629 1149.0629 1177.7895 1177.7895
 [99] 1177.7895 1177.7895 1177.7895 1177.7895 1177.7895 1177.7895 1177.7895
[106] 1177.7895 1177.7895 1177.7895 1207.2342 1207.2342 1207.2342 1207.2342
[113] 1207.2342 1207.2342 1207.2342 1207.2342 1207.2342 1207.2342 1207.2342
[120] 1207.2342 1237.4151 1237.4151 1237.4151 1237.4151 1237.4151 1237.4151
[127] 1237.4151 1237.4151 1237.4151 1237.4151 1237.4151 1237.4151 1268.3504
[134] 1268.3504 1268.3504 1268.3504 1268.3504 1268.3504 1268.3504 1268.3504
[141] 1268.3504 1268.3504 1268.3504 1268.3504 1300.0592 1300.0592 1300.0592
[148] 1300.0592 1300.0592 1300.0592 1300.0592 1300.0592 1300.0592 1300.0592
[155] 1300.0592 1300.0592 1332.5607 1332.5607 1332.5607 1332.5607 1332.5607
[162] 1332.5607 1332.5607 1332.5607 1332.5607 1332.5607 1332.5607 1332.5607
[169] 1365.8747 1365.8747 1365.8747 1365.8747 1365.8747 1365.8747 1365.8747
[176] 1365.8747 1365.8747 1365.8747 1365.8747 1365.8747

$balances
  [1] 290000.0 290311.7 290624.8 290939.3 291255.1 291572.4 291891.0 292211.1
  [9] 292532.5 292855.4 293179.7 293505.4 293808.4 294112.7 294418.4 294725.4
 [17] 295033.8 295343.6 295654.7 295967.1 296281.0 296596.2 296912.8 297230.9
 [25] 297525.5 297821.5 298118.7 298417.3 298717.2 299018.4 299320.9 299624.7
 [33] 299930.0 300236.5 300544.4 300853.7 301138.9 301425.4 301713.1 302002.1
 [41] 302292.4 302584.0 302876.9 303171.0 303466.5 303763.2 304061.3 304360.6
 [49] 304635.3 304911.2 305188.3 305466.6 305746.1 306026.9 306308.9 306592.1
 [57] 306876.6 307162.4 307449.4 307737.7 308000.6 308264.6 308529.8 308796.2
 [65] 309063.7 309332.4 309602.3 309873.4 310145.7 310419.2 310693.9 310969.8
 [73] 311219.6 311470.5 311722.5 311975.6 312229.8 312485.1 312741.6 312999.2
 [81] 313257.9 313517.8 313778.8 314040.9 314276.2 314512.6 314749.9 314988.4
 [89] 315227.8 315468.4 315709.9 315952.6 316196.3 316441.1 316687.0 316933.9
 [97] 317153.3 317373.5 317594.8 317817.0 318040.2 318264.4 318489.6 318715.8
[105] 318943.0 319171.2 319400.3 319630.5 319832.3 320034.9 320238.5 320442.9
[113] 320648.3 320854.5 321061.7 321269.8 321478.7 321688.7 321899.5 322111.3
[121] 322293.8 322477.1 322661.2 322846.2 323031.9 323218.5 323405.9 323594.1
[129] 323783.2 323973.1 324163.8 324355.3 324516.8 324679.0 324841.9 325005.5
[137] 325169.9 325334.9 325500.7 325667.2 325834.5 326002.5 326171.2 326340.7
[145] 326479.2 326618.3 326758.1 326898.4 327039.4 327181.0 327323.2 327466.1
[153] 327609.6 327753.7 327898.4 328043.8 328157.3 328271.4 328385.9 328500.9
[161] 328616.4 328732.5 328849.1 328966.1 329083.7 329201.8 329320.4 329439.6
[169] 329526.0 329612.7 329699.8 329787.3 329875.2 329963.5 330052.2 330141.2
[177] 330230.7 330320.6 330410.8 330501.4</code></pre>
</div>
</div>
<p>While the monthly withdrawals start quite low, around $1150, given we assume the market is always improving this method sees the overall wealth grow quite considerably until death. In an ever growing market 4% is probably a conservative withdrawal amount. However this isnâ€™t how the actual market performs, there are periods of growth and periods of recession. However according to this fixed rate analysis, ORP seems to be a clear winner here. This begs the question what if we werenâ€™t so lucky with market returns?</p>
</section>
</section>
<section id="task-7---bootstrapping" class="level2">
<h2 class="anchored" data-anchor-id="task-7---bootstrapping">Task 7 - Bootstrapping</h2>
<p>To account for the uncertainties of the market, and the many variables that go into an employees retirement fund, to do a more holistic analysis we will simulate a number of random scenarios to better capture the average performance of TRS and ORP respectively. This process has been abstracted into multiple functions that will run as many simulations as we like. You can take a look at the code but the important details is what has been randomized. We assume a death age of 80 in our simulations.</p>
<ul>
<li><p>Employees starting age: 22-63</p></li>
<li><p>Starting Salary: 40,000-120,000</p></li>
<li><p>Market Returns are randomized monthly based on the Asset, roughly.</p>
<ul>
<li><p>US Returns (-15%, 15%)</p></li>
<li><p>Intl Returns (-10%, 12%)</p></li>
<li><p>Bonds (-1%, 2%)</p></li>
<li><p>Short-Term Debt (-.5%, 1.5%)</p></li>
</ul></li>
</ul>
<section id="orp-results" class="level3">
<h3 class="anchored" data-anchor-id="orp-results">ORP Results</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>adjust_allocation <span class="ot">&lt;-</span> <span class="cf">function</span>(age) {</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (age <span class="sc">&gt;=</span> <span class="dv">25</span> <span class="sc">&amp;</span> age <span class="sc">&lt;=</span> <span class="dv">49</span>) {</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>    asset_allocation <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">US_equities =</span> <span class="fl">0.54</span>, <span class="at">Intl_equities =</span> <span class="fl">0.36</span>, <span class="at">Bonds =</span> <span class="fl">0.10</span>, <span class="at">Short_term_debt =</span> <span class="dv">0</span>)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (age <span class="sc">&gt;=</span> <span class="dv">50</span> <span class="sc">&amp;</span> age <span class="sc">&lt;=</span> <span class="dv">59</span>) {</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>    asset_allocation <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">US_equities =</span> <span class="fl">0.47</span>, <span class="at">Intl_equities =</span> <span class="fl">0.32</span>, <span class="at">Bonds =</span> <span class="fl">0.21</span>, <span class="at">Short_term_debt =</span> <span class="dv">0</span>)</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (age <span class="sc">&gt;=</span> <span class="dv">60</span> <span class="sc">&amp;</span> age <span class="sc">&lt;=</span> <span class="dv">74</span>) {</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>    asset_allocation <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">US_equities =</span> <span class="fl">0.34</span>, <span class="at">Intl_equities =</span> <span class="fl">0.23</span>, <span class="at">Bonds =</span> <span class="fl">0.43</span>, <span class="at">Short_term_debt =</span> <span class="dv">0</span>)</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>    asset_allocation <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">US_equities =</span> <span class="fl">0.19</span>, <span class="at">Intl_equities =</span> <span class="fl">0.13</span>, <span class="at">Bonds =</span> <span class="fl">0.62</span>, <span class="at">Short_term_debt =</span> <span class="fl">0.06</span>)</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(asset_allocation)</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>orp_random <span class="ot">&lt;-</span> <span class="cf">function</span>(start, wages, asset_allocation) {</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>  months <span class="ot">&lt;-</span> <span class="fu">length</span>(wages<span class="sc">$</span>date)</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>  salary <span class="ot">&lt;-</span> <span class="fu">numeric</span>(months)</span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>  salary[<span class="dv">1</span>] <span class="ot">&lt;-</span> start</span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>months) {</span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>    salary[i] <span class="ot">&lt;-</span> salary[i <span class="sc">-</span> <span class="dv">1</span>] <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">+</span> (<span class="fu">as.numeric</span>(wages<span class="sc">$</span>value[i <span class="sc">-</span> <span class="dv">1</span>]))<span class="sc">/</span><span class="dv">1200</span>)</span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>  monthly <span class="ot">&lt;-</span> salary <span class="sc">/</span> <span class="dv">12</span></span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>  employee_rate <span class="ot">&lt;-</span> <span class="fu">sapply</span>(salary, <span class="cf">function</span>(s) {</span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (s <span class="sc">&lt;=</span> <span class="dv">45000</span>) <span class="fu">return</span>(<span class="fl">0.03</span>)</span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (s <span class="sc">&lt;=</span> <span class="dv">55000</span>) <span class="fu">return</span>(<span class="fl">0.035</span>)</span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (s <span class="sc">&lt;=</span> <span class="dv">75000</span>) <span class="fu">return</span>(<span class="fl">0.045</span>)</span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (s <span class="sc">&lt;=</span> <span class="dv">100000</span>) <span class="fu">return</span>(<span class="fl">0.0575</span>)</span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fl">0.06</span>)</span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a>  employer_rate <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(.<span class="dv">08</span>, <span class="dv">7</span> <span class="sc">*</span> <span class="dv">12</span>), <span class="fu">rep</span>(.<span class="dv">1</span>, (months <span class="sc">-</span> <span class="dv">7</span> <span class="sc">*</span> <span class="dv">12</span>)))</span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a>  employee_contribution <span class="ot">&lt;-</span> monthly <span class="sc">*</span> employee_rate</span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a>  employer_contribution <span class="ot">&lt;-</span> monthly <span class="sc">*</span> employer_rate</span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a>  total_contribution <span class="ot">&lt;-</span> employee_contribution <span class="sc">+</span> employer_contribution</span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a>  orp_balance <span class="ot">&lt;-</span> <span class="fu">numeric</span>(months)</span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>months) {</span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true" tabindex="-1"></a>    growth_rate <span class="ot">&lt;-</span> <span class="fu">sum</span>(</span>
<span id="cb17-35"><a href="#cb17-35" aria-hidden="true" tabindex="-1"></a>      <span class="fu">runif</span>(<span class="dv">1</span>, <span class="sc">-</span>.<span class="dv">15</span>, .<span class="dv">15</span>) <span class="sc">*</span> asset_allocation[<span class="st">"US_equities"</span>],</span>
<span id="cb17-36"><a href="#cb17-36" aria-hidden="true" tabindex="-1"></a>      <span class="fu">runif</span>(<span class="dv">1</span>, <span class="sc">-</span>.<span class="dv">1</span>, .<span class="dv">12</span>) <span class="sc">*</span> asset_allocation[<span class="st">"Intl_equities"</span>],</span>
<span id="cb17-37"><a href="#cb17-37" aria-hidden="true" tabindex="-1"></a>      <span class="fu">runif</span>(<span class="dv">1</span>, <span class="sc">-</span>.<span class="dv">01</span>, .<span class="dv">02</span>) <span class="sc">*</span> asset_allocation[<span class="st">"Bonds"</span>],</span>
<span id="cb17-38"><a href="#cb17-38" aria-hidden="true" tabindex="-1"></a>      <span class="fu">runif</span>(<span class="dv">1</span>, <span class="sc">-</span>.<span class="dv">005</span>, .<span class="dv">015</span>) <span class="sc">*</span> asset_allocation[<span class="st">"Short_term_debt"</span>]</span>
<span id="cb17-39"><a href="#cb17-39" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb17-40"><a href="#cb17-40" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (i <span class="sc">==</span> <span class="dv">1</span>) {</span>
<span id="cb17-41"><a href="#cb17-41" aria-hidden="true" tabindex="-1"></a>      orp_balance[i] <span class="ot">&lt;-</span> total_contribution[i]</span>
<span id="cb17-42"><a href="#cb17-42" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb17-43"><a href="#cb17-43" aria-hidden="true" tabindex="-1"></a>      orp_balance[i] <span class="ot">&lt;-</span> (orp_balance[i <span class="sc">-</span> <span class="dv">1</span>]<span class="sc">*</span>(<span class="dv">1</span><span class="sc">+</span> growth_rate) <span class="sc">+</span> total_contribution[i]) </span>
<span id="cb17-44"><a href="#cb17-44" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb17-45"><a href="#cb17-45" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb17-46"><a href="#cb17-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(orp_balance[months])</span>
<span id="cb17-47"><a href="#cb17-47" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb17-48"><a href="#cb17-48" aria-hidden="true" tabindex="-1"></a>simulate_orp_withdrawals_random <span class="ot">&lt;-</span> <span class="cf">function</span>(</span>
<span id="cb17-49"><a href="#cb17-49" aria-hidden="true" tabindex="-1"></a>    initial_balance, </span>
<span id="cb17-50"><a href="#cb17-50" aria-hidden="true" tabindex="-1"></a>    annual_withdrawal, </span>
<span id="cb17-51"><a href="#cb17-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">asset_allocation =</span> <span class="fu">c</span>(<span class="at">US_equities =</span> <span class="fl">0.54</span>, <span class="at">Intl_equities =</span> <span class="fl">0.36</span>, <span class="at">Bonds =</span> <span class="fl">0.1</span>, <span class="at">Short_term_debt =</span> <span class="dv">0</span>),</span>
<span id="cb17-52"><a href="#cb17-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">inflation_rate =</span> <span class="fl">0.025</span>,</span>
<span id="cb17-53"><a href="#cb17-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">retirement_years =</span> <span class="dv">15</span></span>
<span id="cb17-54"><a href="#cb17-54" aria-hidden="true" tabindex="-1"></a>) {</span>
<span id="cb17-55"><a href="#cb17-55" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Number of months in retirement</span></span>
<span id="cb17-56"><a href="#cb17-56" aria-hidden="true" tabindex="-1"></a>  months <span class="ot">&lt;-</span> retirement_years <span class="sc">*</span> <span class="dv">12</span></span>
<span id="cb17-57"><a href="#cb17-57" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-58"><a href="#cb17-58" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Convert annual growth and inflation rates to monthly rates</span></span>
<span id="cb17-59"><a href="#cb17-59" aria-hidden="true" tabindex="-1"></a>  monthly_growth_rate <span class="ot">&lt;-</span> <span class="fu">sum</span>(</span>
<span id="cb17-60"><a href="#cb17-60" aria-hidden="true" tabindex="-1"></a>    <span class="fu">runif</span>(<span class="dv">1</span>, <span class="sc">-</span>.<span class="dv">15</span>, .<span class="dv">15</span>) <span class="sc">*</span> asset_allocation[<span class="st">"US_equities"</span>],</span>
<span id="cb17-61"><a href="#cb17-61" aria-hidden="true" tabindex="-1"></a>    <span class="fu">runif</span>(<span class="dv">1</span>, <span class="sc">-</span>.<span class="dv">1</span>, .<span class="dv">12</span>) <span class="sc">*</span> asset_allocation[<span class="st">"Intl_equities"</span>],</span>
<span id="cb17-62"><a href="#cb17-62" aria-hidden="true" tabindex="-1"></a>    <span class="fu">runif</span>(<span class="dv">1</span>, <span class="sc">-</span>.<span class="dv">01</span>, .<span class="dv">02</span>) <span class="sc">*</span> asset_allocation[<span class="st">"Bonds"</span>],</span>
<span id="cb17-63"><a href="#cb17-63" aria-hidden="true" tabindex="-1"></a>    <span class="fu">runif</span>(<span class="dv">1</span>, <span class="sc">-</span>.<span class="dv">005</span>, .<span class="dv">015</span>) <span class="sc">*</span> asset_allocation[<span class="st">"Short_term_debt"</span>]</span>
<span id="cb17-64"><a href="#cb17-64" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb17-65"><a href="#cb17-65" aria-hidden="true" tabindex="-1"></a>  monthly_growth_rate <span class="ot">&lt;-</span> (<span class="dv">1</span> <span class="sc">+</span> monthly_growth_rate)<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">/</span> <span class="dv">12</span>) <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb17-66"><a href="#cb17-66" aria-hidden="true" tabindex="-1"></a>  monthly_inflation_rate <span class="ot">&lt;-</span> (<span class="dv">1</span> <span class="sc">+</span> inflation_rate)<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">/</span> <span class="dv">12</span>) <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb17-67"><a href="#cb17-67" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-68"><a href="#cb17-68" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Initialize vectors to track balances and withdrawals</span></span>
<span id="cb17-69"><a href="#cb17-69" aria-hidden="true" tabindex="-1"></a>  orp_balance <span class="ot">&lt;-</span> <span class="fu">numeric</span>(months)</span>
<span id="cb17-70"><a href="#cb17-70" aria-hidden="true" tabindex="-1"></a>  withdrawals <span class="ot">&lt;-</span> <span class="fu">numeric</span>(months)</span>
<span id="cb17-71"><a href="#cb17-71" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-72"><a href="#cb17-72" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Set initial values</span></span>
<span id="cb17-73"><a href="#cb17-73" aria-hidden="true" tabindex="-1"></a>  orp_balance[<span class="dv">1</span>] <span class="ot">&lt;-</span> initial_balance</span>
<span id="cb17-74"><a href="#cb17-74" aria-hidden="true" tabindex="-1"></a>  withdrawals[<span class="dv">1</span>] <span class="ot">&lt;-</span> annual_withdrawal <span class="sc">/</span> <span class="dv">12</span></span>
<span id="cb17-75"><a href="#cb17-75" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-76"><a href="#cb17-76" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Simulate withdrawals and returns over retirement</span></span>
<span id="cb17-77"><a href="#cb17-77" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>months) {</span>
<span id="cb17-78"><a href="#cb17-78" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Adjust withdrawal for inflation annually</span></span>
<span id="cb17-79"><a href="#cb17-79" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (i <span class="sc">%%</span> <span class="dv">12</span> <span class="sc">==</span> <span class="dv">1</span>) {</span>
<span id="cb17-80"><a href="#cb17-80" aria-hidden="true" tabindex="-1"></a>      withdrawals[i] <span class="ot">&lt;-</span> withdrawals[i <span class="sc">-</span> <span class="dv">1</span>] <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">+</span> inflation_rate)</span>
<span id="cb17-81"><a href="#cb17-81" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb17-82"><a href="#cb17-82" aria-hidden="true" tabindex="-1"></a>      withdrawals[i] <span class="ot">&lt;-</span> withdrawals[i <span class="sc">-</span> <span class="dv">1</span>]</span>
<span id="cb17-83"><a href="#cb17-83" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb17-84"><a href="#cb17-84" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb17-85"><a href="#cb17-85" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Update ORP balance: apply growth, then subtract withdrawal</span></span>
<span id="cb17-86"><a href="#cb17-86" aria-hidden="true" tabindex="-1"></a>    orp_balance[i] <span class="ot">&lt;-</span> orp_balance[i <span class="sc">-</span> <span class="dv">1</span>] <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">+</span> monthly_growth_rate) <span class="sc">-</span> withdrawals[i]</span>
<span id="cb17-87"><a href="#cb17-87" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb17-88"><a href="#cb17-88" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Prevent negative balance</span></span>
<span id="cb17-89"><a href="#cb17-89" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (orp_balance[i] <span class="sc">&lt;</span> <span class="dv">0</span>) {</span>
<span id="cb17-90"><a href="#cb17-90" aria-hidden="true" tabindex="-1"></a>      orp_balance[i] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb17-91"><a href="#cb17-91" aria-hidden="true" tabindex="-1"></a>      withdrawals[i] <span class="ot">&lt;-</span> <span class="dv">0</span> <span class="co"># No more withdrawals if the balance is exhausted</span></span>
<span id="cb17-92"><a href="#cb17-92" aria-hidden="true" tabindex="-1"></a>      <span class="cf">break</span></span>
<span id="cb17-93"><a href="#cb17-93" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb17-94"><a href="#cb17-94" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb17-95"><a href="#cb17-95" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-96"><a href="#cb17-96" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Return a list of results</span></span>
<span id="cb17-97"><a href="#cb17-97" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(</span>
<span id="cb17-98"><a href="#cb17-98" aria-hidden="true" tabindex="-1"></a>    <span class="at">final_balance =</span> orp_balance[months],</span>
<span id="cb17-99"><a href="#cb17-99" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_withdrawn =</span> <span class="fu">sum</span>(withdrawals),</span>
<span id="cb17-100"><a href="#cb17-100" aria-hidden="true" tabindex="-1"></a>    <span class="at">funds_exhausted =</span> <span class="fu">any</span>(orp_balance <span class="sc">==</span> <span class="dv">0</span>),</span>
<span id="cb17-101"><a href="#cb17-101" aria-hidden="true" tabindex="-1"></a>    <span class="at">withdrawals =</span> withdrawals,</span>
<span id="cb17-102"><a href="#cb17-102" aria-hidden="true" tabindex="-1"></a>    <span class="at">balances =</span> orp_balance</span>
<span id="cb17-103"><a href="#cb17-103" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb17-104"><a href="#cb17-104" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb17-105"><a href="#cb17-105" aria-hidden="true" tabindex="-1"></a>bootstrap_orp <span class="ot">&lt;-</span> <span class="cf">function</span>(wages, n_bootstrap, asset_allocation_func) {</span>
<span id="cb17-106"><a href="#cb17-106" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">123</span>)  <span class="co"># for reproducibility</span></span>
<span id="cb17-107"><a href="#cb17-107" aria-hidden="true" tabindex="-1"></a>  bootstrap_results <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_bootstrap)</span>
<span id="cb17-108"><a href="#cb17-108" aria-hidden="true" tabindex="-1"></a>  avg_monthly_income <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_bootstrap)</span>
<span id="cb17-109"><a href="#cb17-109" aria-hidden="true" tabindex="-1"></a>  exhaustion_count <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb17-110"><a href="#cb17-110" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_bootstrap) {</span>
<span id="cb17-111"><a href="#cb17-111" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Randomly sample a starting salary between $40,000 and $120,000</span></span>
<span id="cb17-112"><a href="#cb17-112" aria-hidden="true" tabindex="-1"></a>    start_salary <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="at">min =</span> <span class="dv">40000</span>, <span class="at">max =</span> <span class="dv">120000</span>)</span>
<span id="cb17-113"><a href="#cb17-113" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Randomly sample a starting age between 22 and 63</span></span>
<span id="cb17-114"><a href="#cb17-114" aria-hidden="true" tabindex="-1"></a>    age_at_start <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">22</span><span class="sc">:</span><span class="dv">63</span>, <span class="dv">1</span>)</span>
<span id="cb17-115"><a href="#cb17-115" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Assume death age is 80</span></span>
<span id="cb17-116"><a href="#cb17-116" aria-hidden="true" tabindex="-1"></a>    death_age <span class="ot">&lt;-</span> <span class="dv">80</span></span>
<span id="cb17-117"><a href="#cb17-117" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate the ORP balance for each resample</span></span>
<span id="cb17-118"><a href="#cb17-118" aria-hidden="true" tabindex="-1"></a>    orp_balance_working <span class="ot">&lt;-</span> <span class="fu">orp_random</span>(start_salary, wages,</span>
<span id="cb17-119"><a href="#cb17-119" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">asset_allocation_func</span>(age_at_start))</span>
<span id="cb17-120"><a href="#cb17-120" aria-hidden="true" tabindex="-1"></a>    retirement_years <span class="ot">&lt;-</span> death_age <span class="sc">-</span> age_at_start <span class="sc">-</span> <span class="dv">17</span></span>
<span id="cb17-121"><a href="#cb17-121" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (retirement_years <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb17-122"><a href="#cb17-122" aria-hidden="true" tabindex="-1"></a>      orp_simulation <span class="ot">&lt;-</span> <span class="fu">simulate_orp_withdrawals_random</span>(orp_balance_working, .<span class="dv">04</span><span class="sc">*</span>orp_balance_working, <span class="at">retirement_years =</span> retirement_years)</span>
<span id="cb17-123"><a href="#cb17-123" aria-hidden="true" tabindex="-1"></a>      bootstrap_results[i] <span class="ot">&lt;-</span> orp_simulation<span class="sc">$</span>final_balance</span>
<span id="cb17-124"><a href="#cb17-124" aria-hidden="true" tabindex="-1"></a>      avg_monthly_income[i] <span class="ot">&lt;-</span> bootstrap_results[i]<span class="sc">/</span>retirement_years<span class="sc">/</span><span class="dv">12</span></span>
<span id="cb17-125"><a href="#cb17-125" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (orp_simulation<span class="sc">$</span>final_balance <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb17-126"><a href="#cb17-126" aria-hidden="true" tabindex="-1"></a>        exhaustion_count <span class="ot">&lt;-</span> exhaustion_count <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb17-127"><a href="#cb17-127" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb17-128"><a href="#cb17-128" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb17-129"><a href="#cb17-129" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> {</span>
<span id="cb17-130"><a href="#cb17-130" aria-hidden="true" tabindex="-1"></a>      bootstrap_results[i] <span class="ot">&lt;-</span> orp_balance_working</span>
<span id="cb17-131"><a href="#cb17-131" aria-hidden="true" tabindex="-1"></a>      avg_monthly_income[i] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb17-132"><a href="#cb17-132" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb17-133"><a href="#cb17-133" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb17-134"><a href="#cb17-134" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-135"><a href="#cb17-135" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Return a summary of the bootstrap results</span></span>
<span id="cb17-136"><a href="#cb17-136" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(</span>
<span id="cb17-137"><a href="#cb17-137" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean =</span> <span class="fu">mean</span>(bootstrap_results),</span>
<span id="cb17-138"><a href="#cb17-138" aria-hidden="true" tabindex="-1"></a>    <span class="at">lower_ci =</span> <span class="fu">quantile</span>(bootstrap_results, <span class="fl">0.025</span>),  <span class="co"># 95% CI lower bound</span></span>
<span id="cb17-139"><a href="#cb17-139" aria-hidden="true" tabindex="-1"></a>    <span class="at">upper_ci =</span> <span class="fu">quantile</span>(bootstrap_results, <span class="fl">0.975</span>),  <span class="co"># 95% CI upper bound</span></span>
<span id="cb17-140"><a href="#cb17-140" aria-hidden="true" tabindex="-1"></a>    <span class="at">exhaustion_percentage =</span> exhaustion_count <span class="sc">/</span> n_bootstrap,</span>
<span id="cb17-141"><a href="#cb17-141" aria-hidden="true" tabindex="-1"></a>    <span class="at">results =</span> bootstrap_results,</span>
<span id="cb17-142"><a href="#cb17-142" aria-hidden="true" tabindex="-1"></a>    <span class="at">monthly_income =</span> avg_monthly_income</span>
<span id="cb17-143"><a href="#cb17-143" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb17-144"><a href="#cb17-144" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb17-145"><a href="#cb17-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-146"><a href="#cb17-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-147"><a href="#cb17-147" aria-hidden="true" tabindex="-1"></a>bootstrap_orp_results <span class="ot">&lt;-</span> <span class="fu">bootstrap_orp</span>(<span class="fu">filter</span>(wages, date <span class="sc">&gt;=</span> <span class="st">"2007-04-30"</span>), <span class="dv">200</span>, adjust_allocation)</span>
<span id="cb17-148"><a href="#cb17-148" aria-hidden="true" tabindex="-1"></a><span class="fu">as.data.frame</span>(bootstrap_orp_results) <span class="sc">|&gt;</span> </span>
<span id="cb17-149"><a href="#cb17-149" aria-hidden="true" tabindex="-1"></a>    DT<span class="sc">::</span><span class="fu">datatable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-994fb63aa0bb6dc0f123" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-994fb63aa0bb6dc0f123">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175","176","177","178","179","180","181","182","183","184","185","186","187","188","189","190","191","192","193","194","195","196","197","198","199","200"],[639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322,639275.2161420322],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311,5489143.723374311],[0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38,0.38],[0,208120.4342752246,390834.4745457515,0,923939.3097613582,682859.5263886942,0,305692.486575056,742134.524305843,141781.2559339646,0,538746.4103924448,186556.9469351569,3319887.789523603,269589.7750963633,109121.5765267245,0,212504.4905776213,108836.135365904,379628.8835447968,2311697.629534192,105383.8795888743,246856.378719211,0,0,119627.352942281,6524417.853538028,71342.75221872161,685487.8045524493,0,88540.31876975662,223216.7234447991,0,0,682129.0819841997,118189.6620187696,0,0,56223.339174857,0,0,282494.660600759,0,0,11409.11541894411,178823.2460945643,0,0,717025.4450836739,171997.5911134148,0,0,14312882.5037203,192141.7156862665,0,46.35746914699291,402525.4360782964,0,0,0,0,253367.7230679454,0,0,487088.4467048779,0,202192.0306940911,487020.102422733,0,309458.5781033657,5462598.232857286,402998.3433429956,3077454.884790308,0,0,0,275866.55006382,0,274261.2273270558,294392.9063762173,205105.9721513788,222336.9167744593,237557.6975427279,0,0,33308.19545084355,565414.1523214255,173237.1813358027,73375.46728665904,0,1442724.952958486,19676337.39692044,0,215544.2482035249,2197515.693822996,108052.9064445381,0,1029241.371725277,530190.7690810891,737988.5577614742,1388980.180745726,309540.8363143972,0,673749.1402005843,466422.9755832744,247116.7402289366,3708464.948256146,0,0,385829.6043789012,383714.669633398,1636210.437953485,649438.6789438452,0,565388.958915372,585197.5940374783,0,0,0,224375.5578458883,284355.3942019788,24087.97733322006,0,0,0,8084523.216332082,0,289431.4372733639,467257.759777246,770454.0378197873,347297.9620072388,689163.4204207134,0,0,308282.3454230122,0,376715.2650950197,294683.4337343728,0,284418.162939099,0,1077438.579880373,0,0,0,118222.2381015482,0,393637.3265432739,947839.584474906,106311.0081970847,15978.66923362649,0,0,704037.8879471482,201293.0242918558,412239.7373867796,0,478444.2471479788,0,0,0,701699.9418973993,0,0,241369.8244751668,355934.2186655042,141363.5988939757,11327716.68122661,92618.71918676926,171930.0243695337,47681.60032514911,4273380.308036129,86247.61896234348,1635234.3662397,0,251009.2699991221,660088.6465280604,193407.7367500015,326200.8795747758,371913.2477929757,2014830.651467904,0,482852.8405789353,86735.53409874634,34936.33547681349,0,0,0,224274.9842378884,0,71762.30422214157,0,102638.3123525275,0,0,426033.5159385154,0,99451.0562719593,336687.2349758289,199177.3642309878],[0,2890.561587155897,1357.064147728304,0,2566.49808267044,7113.120066548898,0,3639.196268750666,1932.6419903798,984.5920550969767,0,2040.706099971382,1943.30153057455,6916.432894840839,7488.60486378787,909.3464710560373,0,4427.176887033776,1133.709743394834,6327.148059079947,7705.658765113973,2927.329988579841,20571.36489326759,0,0,284.8270308149546,13592.53719487089,228.6626673676975,19041.3279042347,0,320.7982564121617,9300.696810199963,0,0,4372.622320411537,984.913850156413,0,0,425.9343876883106,0,0,2140.111065157265,0,0,86.43269256775842,3725.484293636755,0,0,29876.06021181975,2047.590370397795,0,0,31387.9002274568,5337.269880174069,0,0.3219268690763397,4192.973292482254,0,0,0,0,1624.152070948368,0,0,40590.70389207316,0,3369.867178234852,40585.00853522775,0,2578.821484194714,11102.8419367018,3358.319527858297,7542.781580368402,0,0,0,4597.775834397001,0,2077.736570659514,1635.516146534541,1899.129371772026,6176.025465957203,9898.237397613664,0,0,198.263068159783,0,2887.286355596712,555.8747521716595,0,0,42043.45597632573,0,816.4554856194127,9156.31539092915,473.9162563356935,0,6597.701100803059,2008.298367731398,7687.380810015356,5261.28856343078,3224.383711608305,0,56145.76168338203,7773.716259721241,1083.845351881301,13436.46720382661,0,0,1692.235106925005,4568.031781349976,5244.264224209888,2004.440367110634,0,2048.510720707869,4433.315106344533,0,0,0,2077.551461536002,23696.2828501649,133.822096295667,0,0,0,18714.17411187982,0,927.6648630556534,2433.63416550649,32102.25157582447,0,1980.35465638136,0,0,642.2548862979421,0,3488.104306435367,2728.550312355304,0,1247.448083066223,0,8162.413483942218,0,0,0,351.8518991117506,0,6560.622109054566,3037.947386137519,553.7031676931496,121.0505244971703,0,0,3911.321599706378,1677.441869098799,3123.028313536209,0,1476.679775148083,0,0,0,9745.832526352768,0,0,3352.358673266206,1977.412325919468,1308.922211981256,24204.52282313379,857.5807332108265,511.6965010998027,189.2126997029727,13696.73175652605,449.2063487622056,5924.762196520653,0,10458.71958329675,4583.948934222642,2686.218565972243,0,3099.277064941465,6995.939762041333,0,3657.976064991934,602.3300979079607,242.6134408112048,0,0,0,602.8897425749687,0,598.0192018511797,0,407.2948902878074,0,0,7100.558598975257,0,436.1888432980671,7014.317395329769,1106.540912394377]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>mean<\/th>\n      <th>lower_ci<\/th>\n      <th>upper_ci<\/th>\n      <th>exhaustion_percentage<\/th>\n      <th>results<\/th>\n      <th>monthly_income<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[1,2,3,4,5,6]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"mean","targets":1},{"name":"lower_ci","targets":2},{"name":"upper_ci","targets":3},{"name":"exhaustion_percentage","targets":4},{"name":"results","targets":5},{"name":"monthly_income","targets":6}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="trs-results" class="level3">
<h3 class="anchored" data-anchor-id="trs-results">TRS Results</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>bootstrap_trs <span class="ot">&lt;-</span> <span class="cf">function</span>(wages, inflation, n_bootstrap) {</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">123</span>)  <span class="co"># for reproducibility</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  bootstrap_results <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_bootstrap)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  avg_monthly_income <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_bootstrap)</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_bootstrap) {</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Resample wages and inflation with replacement</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>    start_salary <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="at">min =</span> <span class="dv">40000</span>, <span class="at">max =</span> <span class="dv">120000</span>)</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>    sampled_wages <span class="ot">&lt;-</span> wages[<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(wages), <span class="fu">nrow</span>(wages), <span class="at">replace =</span> <span class="cn">TRUE</span>), ]</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>    sampled_inflation <span class="ot">&lt;-</span> inflation[<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(inflation), <span class="fu">nrow</span>(inflation), <span class="at">replace =</span> <span class="cn">TRUE</span>), ]</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Randomly sample a starting age between 22 and 60</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>    age_at_start <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">22</span><span class="sc">:</span><span class="dv">63</span>, <span class="dv">1</span>)</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Assume death age is 80</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>    death_age <span class="ot">&lt;-</span> <span class="dv">80</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate the TRS balance for each resample</span></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>    retirement_years <span class="ot">&lt;-</span> death_age <span class="sc">-</span> age_at_start <span class="sc">-</span> <span class="dv">17</span></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>    bootstrap_results[i] <span class="ot">&lt;-</span> <span class="fu">trs</span>(start_salary, sampled_wages, sampled_inflation, retirement_years)</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>    avg_monthly_income[i] <span class="ot">&lt;-</span> bootstrap_results[i]<span class="sc">/</span>retirement_years<span class="sc">/</span><span class="dv">12</span></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Return a summary of the bootstrap results</span></span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(</span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean =</span> <span class="fu">mean</span>(bootstrap_results),</span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">lower_ci =</span> <span class="fu">quantile</span>(bootstrap_results, <span class="fl">0.025</span>),  <span class="co"># 95% CI lower bound</span></span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">upper_ci =</span> <span class="fu">quantile</span>(bootstrap_results, <span class="fl">0.975</span>),  <span class="co"># 95% CI upper bound</span></span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">results =</span> bootstrap_results,</span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">monthly_income =</span> avg_monthly_income</span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true" tabindex="-1"></a>bootstrap_trs_results <span class="ot">&lt;-</span> <span class="fu">bootstrap_trs</span>(<span class="fu">filter</span>(wages, date <span class="sc">&gt;=</span> <span class="st">"2007-04-30"</span>), inflation, <span class="dv">200</span>)</span>
<span id="cb18-32"><a href="#cb18-32" aria-hidden="true" tabindex="-1"></a><span class="fu">as.data.frame</span>(bootstrap_trs_results) <span class="sc">|&gt;</span> </span>
<span id="cb18-33"><a href="#cb18-33" aria-hidden="true" tabindex="-1"></a>    DT<span class="sc">::</span><span class="fu">datatable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-d26b8aeae13cb7995ed4" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-d26b8aeae13cb7995ed4">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175","176","177","178","179","180","181","182","183","184","185","186","187","188","189","190","191","192","193","194","195","196","197","198","199","200"],[1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308,1289275.587030308],[55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784,55996.8436865784],[3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446,3957516.448667446],[1345320.201888863,1157010.939583658,567539.2411078279,243179.559691557,597630.2463641131,1261473.369683611,1936955.777525071,806019.5632617663,272474.4648162182,2059332.099553195,154995.4743776852,1431374.883053195,534553.1294304498,2622540.747515976,769566.4673753507,1269089.984152663,817725.7471298252,1608864.59416265,1018983.621308167,1718314.528029483,507846.4380684799,1000276.042457675,1225733.851874094,53803.47627725912,826993.7049121328,147530.4841356729,2692132.667094826,1467906.152692396,3275693.63439684,1341386.096131823,170841.87868246,4263342.394244757,4353399.139848037,634174.9069020138,1404435.277748777,3193722.636374178,1897345.930513793,1987794.469109258,1795948.194334905,720158.1447773502,2419155.76391393,1107026.056243756,1616034.739238491,246607.9526694078,434633.5214381728,2327777.750400201,1998445.689382946,720457.3389670459,546013.616389394,1281940.080260596,860918.8917178494,43513.89961582093,150426.73773595,877963.1696952952,1469396.31878356,957515.1679281051,3057270.096788334,393934.5054589642,824473.0391462515,455527.8503378387,1489242.824192302,503460.107783853,675705.6236934834,620019.1241198337,1009679.051476082,493109.8631454685,1837366.219543637,2813216.574688061,1049089.744505319,193358.8508428175,1594414.594367886,1256948.767262715,182907.7916095017,525655.4433584234,1192004.001696428,2074976.366850794,193955.2770505045,1547234.353659566,572035.782930591,156969.5955980757,1907878.509559156,3651551.045090912,4441304.763258175,102447.5138011149,481239.1037229321,596586.6042153912,1666081.044436106,1696855.490715627,380598.1020486988,3954028.842240346,2692154.427060599,3412871.734351441,1304860.150126632,809786.3774212025,1704206.092052351,3353979.240112093,1179132.945344737,1606801.530286279,716916.7435437361,2096171.220765185,741306.0498382517,2112272.895707208,218899.5940252572,613596.7539659815,1342443.053491553,727833.823977472,720365.7284420824,643427.1714868508,2243502.898066007,762177.3325590673,511315.654963806,286338.1805787606,1725449.75726052,1077447.140200025,164623.2501511021,1612301.690237818,1172788.348532484,1316017.993140805,239290.4961338851,158552.5401262658,515777.6035517866,2490639.060054837,1020058.030929741,888325.7268107765,821552.8375659357,1269467.777778897,2754722.877466151,1246258.887264732,1712545.949976315,1077549.523420686,1751646.791842318,211985.1415159347,1179417.770807076,1020434.66032376,2505952.120669418,1736334.422024627,3320748.725701826,966208.5330969248,33198.84773219728,587686.2313963027,710863.6693453534,824753.2448811535,1536816.063997111,289919.4714949235,2869677.357507573,522526.4624450379,2295501.814110265,2313487.230310492,1831901.504448135,752757.8692228906,613245.0617495255,725197.9269189996,2025534.071210516,700483.5281079178,2424811.06853421,294399.2348391188,3241086.276513692,45594.67950474694,1359407.252085936,1995222.981166865,2859484.222406653,415818.7060513142,695372.8702237423,772593.4051271304,443531.6749118428,3425575.921903212,2254098.680221704,497248.3115111299,286598.206773398,647237.7647997895,2536653.495733076,254998.4498078107,435609.7928989148,1452823.697210874,1125344.187190751,409222.5858671388,1883929.187122447,512547.150453946,1668467.620306823,910780.0880198986,167037.3759720387,1371805.864848172,3056416.647855193,2067326.765906538,56053.08387656094,32518.89634660058,4312465.795382608,275196.0487058331,1944409.053409099,494649.2948758142,495114.5778261342,781228.7215369154,277483.8341575013,195299.8140125262,1302685.192060518,2145348.782231215,2757236.699912055,435974.1700166551,4093533.09932432,552505.2428256911],[4003.929172288283,4820.878914931906,3941.244729915471,2026.496330762975,3557.322895024482,5840.154489275978,5380.43271534742,2583.396036095405,2064.200491031957,5917.620975727572,1845.184218781966,4970.051677268038,4949.566013244906,5751.185849815737,5830.048995267808,3646.810299289261,3097.446011855398,4965.631463464969,4469.226409246345,6508.767151626828,5290.067063213332,5954.024062248064,6008.499273892619,4483.623023104927,2996.354003304829,2458.841402261216,7236.915771760286,5825.024415446017,7377.688365758649,5322.960698935804,3559.205805884584,9349.435075098152,9069.581541350077,2935.994939361175,4035.733556749359,8064.956152460046,6588.006703172893,5712.053072153041,5160.770673376165,3000.658936572293,6108.979201802853,3416.747087172085,5179.59852320029,5137.665680612663,3621.946011984774,4973.884082051712,4758.204022340348,2858.957694313674,3791.761224926347,6284.020001277429,2989.301707353643,3626.158301318411,2089.260246332639,4572.724842162996,4709.603585844744,5699.495047191102,7720.379032293772,5471.312575818946,5285.083584270843,3450.968563165445,5909.693746794847,2622.188061374235,3128.26677635872,5166.826034331948,3824.541861651825,2282.916033080873,6657.123983853756,6895.13866345113,3496.965815017729,4028.309392558698,5110.303187076556,6161.51356501331,5080.771989152824,2305.506330519401,3311.122226934522,4803.186034376838,3232.587950841741,6446.809806914858,4333.604416140841,4360.266544390992,5299.66252655321,8452.664456228964,9252.718256787864,4268.646408379788,4455.917627064186,5523.9500390314,6611.432716016295,4158.959536067714,2883.318954914384,8448.779577436637,6409.891493001425,7292.460970836412,3398.073307621436,3067.372641746979,6174.659753812866,7355.217631824766,3388.313061335453,4319.358952382469,4267.361568712715,4852.248196215706,3251.342323851981,6770.105434958999,4560.408208859524,5113.306283049847,4661.260602401225,5054.401555399111,4617.729028474888,4874.448268839779,5341.673566823825,4234.318514217041,2367.202106313917,3976.919174705009,4493.358742865938,3903.793986231974,4572.868059752837,3951.71982901426,3370.081461300242,3655.605536502237,2492.609334727969,2642.542335437763,2528.32158603817,5461.927763278151,5312.802244425734,2741.746070403631,2535.656906067702,3778.177910056241,5599.030238752341,4945.471774860049,6486.916477183011,5612.237101149408,6346.546347254774,2208.178557457653,5781.459660819,6074.015835260475,5966.55266826052,6291.066746466039,7479.163796625734,3500.755554699003,null,2448.692630817928,3702.414944507049,4909.245505244961,5122.720213323703,3451.42227970147,7714.186444912832,5442.983983802478,7357.377609327773,6885.378661638369,4924.466409806816,3484.99013529116,3406.917009719586,3777.072536036456,5444.984062393861,3433.742784842734,6518.309324016694,4906.653913985313,6587.573732751406,null,6293.552092990442,5195.893180122043,5957.258796680527,2475.111345543537,4457.518398870143,4952.521827738015,4620.121613665029,7136.616503965025,4943.198860135316,3767.032662963105,3411.883413969024,3595.76535999883,5284.694782777241,4249.974163463511,4033.424008323285,3104.324139339474,3349.238652353426,3100.171105054082,4131.423655970278,3050.875895559202,3658.920219971104,3035.933626732995,3479.945332750807,6350.953078000795,7277.182494893317,6626.04732662352,4671.090323046745,2709.908028883382,8984.303740380432,2293.300405881943,4154.720199592092,4580.086063664946,2750.636543478523,3100.113974352839,3303.378978065492,2034.373062630481,5169.385682779834,5767.066618901116,7658.990833089042,3633.118083472125,8977.046270448071,2877.631473050475]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>mean<\/th>\n      <th>lower_ci<\/th>\n      <th>upper_ci<\/th>\n      <th>results<\/th>\n      <th>monthly_income<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[1,2,3,4,5]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"mean","targets":1},{"name":"lower_ci","targets":2},{"name":"upper_ci","targets":3},{"name":"results","targets":4},{"name":"monthly_income","targets":5}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
</section>
<section id="final-analysis" class="level2">
<h2 class="anchored" data-anchor-id="final-analysis">Final Analysis</h2>
<p>From our simulations we can really see how TRS and ORP really differ on the big stage. While ORP does at times produce staggeringly high wealth, it also introduces an <strong>exhaustion rate close to 40%!</strong> This should be alarming to anyone looking for a secure retirement. There in lies the risk vs reward paradigm of ORP or investing in the market for anyone. While in the long term the market will go up, in the short-term anything can happen and all it takes is one bad year to see your net worth go to zero. While 4% withdrawal is generally a safe conservative bet, assuming average market returns of closer to 6%, this could be a problem in downturn years. A more variable withdrawal rate probably makes more sense based on market conditions, be more conservative on poor years and less on big earning years.</p>
<p>TRS has much more consistent results by the nature of its plan. While it may never be able to reach the heights that can potentially yield from a bullish market it is definitely a more secure option. So the better plan? Well it really would depend person to person. If said employee is depending on this as their only assets through retirement, TRS is most likely the safer bet. However, if an employee has worked for a long time, and built a large ORP account, ORP is probably going to yield greater wealth and thus more inheritance money for said employees family once they die. The longer the tenure at CUNY the better the ORP option is, the potential returns will just be much higher. However, if the money is essential to post-retirement survival or the employees tenure is not as long so their investments are less cumulative and less secure then TRS is the better option.</p>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>